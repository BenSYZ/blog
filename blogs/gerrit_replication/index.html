<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><title>Gerrit Replication</title><script src=/js/if_mobile.js></script>
<script>!function(){$("pre > code").each(function(){var s,n=$(this).parent().attr("class");n==null||n===""?$(this).addClass("hljs"):(s={js:"javascript"},s[n]&&(n=s[n]),$(this).addClass(n))})}</script><link rel=stylesheet href=/css/hljs/snazzy.css><link rel=stylesheet href=/css/hljs/line-numbers.min.css><script src=/js/hljs/highlight.min.js></script>
<script src=/js/hljs/highlightjs-line-numbers.min.js></script>
<script>hljs.highlightAll()</script><script>hljs.initLineNumbersOnLoad()</script><link rel=stylesheet href=/css/code.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/footer.css><link rel=stylesheet href=/css/font-awesome.min.css integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin=anonymous><link rel=icon id=light-scheme-icon href=/favicons/favicon_B_Light.ico type=image/x-icon><link rel=icon id=dark-scheme-icon href=/favicons/favicon_B_Dark.ico type=image/x-icon><script src=/js/favicon.js></script></head><body><div class=container><div class=header><h1>Gerrit Replication</h1>Tue, 2025-05-27<hr></div><div class=middle><div id=TitleWithToc><div id=TitleOfToc>Gerrit Replication</div></div><div id=content><p>[toc]</p><h2 id=introduction>Introduction</h2><p><a href=https://gerrit.googlesource.com/plugins/replication/+doc/master/src/main/resources/Documentation/config.md>Gerrit 官方文档</a></p><p><code>replication</code> 是 Gerrit 提供的插件：当“主服务器”中的相关仓库更新时，会自动同步到“从服务器”，因而可以实现备份，只允许单向流动。它的实现是：用本地的 Unix 帐号，通过 git 向其他服务器 push “本地 Gerrit 工作目录下 git 子目录下的目录仓库”。</p><p><strong>注意</strong>：</p><p><code>replication</code> 的执行和 Gerrit 软件提供的 git 账户没有关系：</p><ul><li>master 端：它不是用 Gerrit 内部的用户来推送到远端的，而是用“启动 Gerrit 软件的 <strong>本地帐号</strong>”</li><li>slave 端：接收不是走 Gerrit 开放的 ssh 端口。而是走“本地账户”的 ssh 端口（不全对，可以参考 replication 后记）</li></ul><p>由于我希望 slave 端接收到从 master 传过来的 git 后，亦能提供 clone fetch 等只读的服务。而这些服务是受限的，权限信息都在 All-Projects.git, All-Users.git 这两个仓库下，最简单的办法就是 slave 端也用 Gerrit 来发布，以避免权限转化和不统一。同时我还要配置 slave 端设成只读。</p><h2 id=配置>配置</h2><h3 id=启动两个-docker>启动两个 docker</h3><p>启动两个 docker</p><div class=sourceCode id=cb1><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id=cb1-1><a href=#cb1-1 aria-hidden=true></a><span class=co># docker-compose.yaml</span></span>
<span id=cb1-2><a href=#cb1-2 aria-hidden=true></a><span class=fu>version</span><span class=kw>:</span><span class=at> </span><span class=st>&#39;3&#39;</span></span>
<span id=cb1-3><a href=#cb1-3 aria-hidden=true></a></span>
<span id=cb1-4><a href=#cb1-4 aria-hidden=true></a><span class=fu>services</span><span class=kw>:</span></span>
<span id=cb1-5><a href=#cb1-5 aria-hidden=true></a><span class=at>  </span><span class=fu>gerrit-1</span><span class=kw>:</span></span>
<span id=cb1-6><a href=#cb1-6 aria-hidden=true></a><span class=at>    </span><span class=fu>image</span><span class=kw>:</span><span class=at> gerritcodereview/gerrit:3.4.0</span></span>
<span id=cb1-7><a href=#cb1-7 aria-hidden=true></a><span class=at>    </span><span class=fu>hostname</span><span class=kw>:</span><span class=at> gerrit-1</span></span>
<span id=cb1-8><a href=#cb1-8 aria-hidden=true></a><span class=at>    </span><span class=fu>volumes</span><span class=kw>:</span></span>
<span id=cb1-9><a href=#cb1-9 aria-hidden=true></a><span class=at>       </span><span class=kw>-</span><span class=at> volume-git-1:/var/gerrit/git</span></span>
<span id=cb1-10><a href=#cb1-10 aria-hidden=true></a><span class=at>       </span><span class=kw>-</span><span class=at> volume-index-1:/var/gerrit/index</span></span>
<span id=cb1-11><a href=#cb1-11 aria-hidden=true></a><span class=at>       </span><span class=kw>-</span><span class=at> volume-cache-1:/var/gerrit/cache</span></span>
<span id=cb1-12><a href=#cb1-12 aria-hidden=true></a><span class=at>    </span><span class=fu>ports</span><span class=kw>:</span></span>
<span id=cb1-13><a href=#cb1-13 aria-hidden=true></a><span class=at>       </span><span class=kw>-</span><span class=at> </span><span class=st>&quot;29418:29418&quot;</span></span>
<span id=cb1-14><a href=#cb1-14 aria-hidden=true></a><span class=at>       </span><span class=kw>-</span><span class=at> </span><span class=st>&quot;18080:8080&quot;</span></span>
<span id=cb1-15><a href=#cb1-15 aria-hidden=true></a></span>
<span id=cb1-16><a href=#cb1-16 aria-hidden=true></a><span class=at>  </span><span class=fu>gerrit-2</span><span class=kw>:</span></span>
<span id=cb1-17><a href=#cb1-17 aria-hidden=true></a><span class=at>    </span><span class=fu>image</span><span class=kw>:</span><span class=at> gerritcodereview/gerrit:3.4.0</span></span>
<span id=cb1-18><a href=#cb1-18 aria-hidden=true></a><span class=at>    </span><span class=fu>hostname</span><span class=kw>:</span><span class=at> gerrit-2</span></span>
<span id=cb1-19><a href=#cb1-19 aria-hidden=true></a><span class=at>    </span><span class=fu>volumes</span><span class=kw>:</span></span>
<span id=cb1-20><a href=#cb1-20 aria-hidden=true></a><span class=at>       </span><span class=kw>-</span><span class=at> volume-git-2:/var/gerrit/git</span></span>
<span id=cb1-21><a href=#cb1-21 aria-hidden=true></a><span class=at>       </span><span class=kw>-</span><span class=at> volume-index-2:/var/gerrit/index</span></span>
<span id=cb1-22><a href=#cb1-22 aria-hidden=true></a><span class=at>       </span><span class=kw>-</span><span class=at> volume-cache-2:/var/gerrit/cache</span></span>
<span id=cb1-23><a href=#cb1-23 aria-hidden=true></a><span class=at>    </span><span class=fu>ports</span><span class=kw>:</span></span>
<span id=cb1-24><a href=#cb1-24 aria-hidden=true></a><span class=at>       </span><span class=kw>-</span><span class=at> </span><span class=st>&quot;29419:29418&quot;</span></span>
<span id=cb1-25><a href=#cb1-25 aria-hidden=true></a><span class=at>       </span><span class=kw>-</span><span class=at> </span><span class=st>&quot;22001:22&quot;</span></span>
<span id=cb1-26><a href=#cb1-26 aria-hidden=true></a><span class=co>       # - &quot;18081:8080&quot; # 由于我们将其配置成 replica，网页端口是无用的</span></span>
<span id=cb1-27><a href=#cb1-27 aria-hidden=true></a></span>
<span id=cb1-28><a href=#cb1-28 aria-hidden=true></a><span class=fu>volumes</span><span class=kw>:</span></span>
<span id=cb1-29><a href=#cb1-29 aria-hidden=true></a><span class=at>  </span><span class=fu>volume-git-1</span><span class=kw>:</span></span>
<span id=cb1-30><a href=#cb1-30 aria-hidden=true></a><span class=at>  </span><span class=fu>volume-index-1</span><span class=kw>:</span></span>
<span id=cb1-31><a href=#cb1-31 aria-hidden=true></a><span class=at>  </span><span class=fu>volume-cache-1</span><span class=kw>:</span></span>
<span id=cb1-32><a href=#cb1-32 aria-hidden=true></a><span class=at>  </span><span class=fu>volume-git-2</span><span class=kw>:</span></span>
<span id=cb1-33><a href=#cb1-33 aria-hidden=true></a><span class=at>  </span><span class=fu>volume-index-2</span><span class=kw>:</span></span>
<span id=cb1-34><a href=#cb1-34 aria-hidden=true></a><span class=at>  </span><span class=fu>volume-cache-2</span><span class=kw>:</span></span></code></pre></div><div class=sourceCode id=cb2><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb2-1><a href=#cb2-1 aria-hidden=true></a><span class=ex>docker</span> compose up</span></code></pre></div><p>Gerrit docker 中的 site_path 在 <code>/var/gerrit/</code>，同时家目录也设置成了这个。</p><h3 id=slave-机的配置>slave 机的配置</h3><h4 id=安装配置-sshd>安装配置 <code>sshd</code></h4><h5 id=进入-slave-gerrit-2>进入 slave Gerrit 2</h5><p>对 slave 机器的配置，除特殊说明外均需要 root 权限。</p><div class=sourceCode id=cb3><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb3-1><a href=#cb3-1 aria-hidden=true></a><span class=ex>docker</span> exec --user root -it gerrit-gerrit-2-1 /bin/bash</span></code></pre></div><h5 id=替换-centos-源>替换 <code>CentOS</code> 源</h5><p>由于我用的是 <code>gerrit:3.4.0</code> 需要替换一下源</p><div class=sourceCode id=cb4><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb4-1><a href=#cb4-1 aria-hidden=true></a><span class=co># https://serverfault.com/questions/1161816/mirrorlist-centos-org-no-longer-resolve</span></span>
<span id=cb4-2><a href=#cb4-2 aria-hidden=true></a><span class=fu>sed</span> -i <span class=st>&#39;s/mirror.centos.org/vault.centos.org/g&#39;</span> /etc/yum.repos.d/CentOS-*.repo</span>
<span id=cb4-3><a href=#cb4-3 aria-hidden=true></a><span class=fu>sed</span> -i <span class=st>&#39;s/^#.*baseurl=http/baseurl=http/g&#39;</span>      /etc/yum.repos.d/CentOS-*.repo</span>
<span id=cb4-4><a href=#cb4-4 aria-hidden=true></a><span class=fu>sed</span> -i <span class=st>&#39;s/^mirrorlist=http/#mirrorlist=http/g&#39;</span>  /etc/yum.repos.d/CentOS-*.repo</span></code></pre></div><h5 id=安装-openssh-server-和-passwd>安装 <code>openssh-server</code> 和 <code>passwd</code></h5><div class=sourceCode id=cb5><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb5-1><a href=#cb5-1 aria-hidden=true></a><span class=ex>yum</span> install -y openssh-server passwd</span></code></pre></div><h5 id=配置密码>配置密码</h5><div class=sourceCode id=cb6><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb6-1><a href=#cb6-1 aria-hidden=true></a><span class=co># 密码自定义</span></span>
<span id=cb6-2><a href=#cb6-2 aria-hidden=true></a><span class=va>password=</span><span class=st>&quot;&lt;gerrit_password&gt;&quot;</span></span>
<span id=cb6-3><a href=#cb6-3 aria-hidden=true></a><span class=bu>echo</span> <span class=st>&quot;</span><span class=va>$password</span><span class=st>&quot;</span> <span class=kw>|</span> <span class=fu>passwd</span> --stdin -f gerrit</span>
<span id=cb6-4><a href=#cb6-4 aria-hidden=true></a><span class=co># 要删除这个文件，否则 ssh 连上来会报 System is booting up. Unprivileged users are not permitted to log in yet</span></span>
<span id=cb6-5><a href=#cb6-5 aria-hidden=true></a><span class=co># https://unix.stackexchange.com/a/487937/442345</span></span>
<span id=cb6-6><a href=#cb6-6 aria-hidden=true></a><span class=fu>rm</span> -f /run/nologin</span></code></pre></div><h5 id=配置-sshd>配置 <code>sshd</code></h5><p>Gerrit docker 的入口是 <code>/entrypoint.sh</code>，由于是使用 <code>gerrit</code> 用户启动这个脚本的，所以我们不能用 root 的 <code>sshd</code> 来启动，所以有两种方案：</p><h6 id=方案一-将配置文件的所有权归属给-gerrit>方案一： 将配置文件的所有权归属给 <code>gerrit</code></h6><p>由于我们使用的是 docker，故我们可以直接修改默认的 <code>sshd</code> 的 host keys</p><div class=sourceCode id=cb7><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb7-1><a href=#cb7-1 aria-hidden=true></a><span class=fu>ssh-keygen</span> -A</span></code></pre></div><div class=sourceCode id=cb8><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb8-1><a href=#cb8-1 aria-hidden=true></a><span class=fu>chown</span> gerrit:gerrit /etc/ssh/sshd_config</span>
<span id=cb8-2><a href=#cb8-2 aria-hidden=true></a><span class=fu>chown</span> gerrit:gerrit /etc/ssh/ssh_host*</span>
<span id=cb8-3><a href=#cb8-3 aria-hidden=true></a><span class=co># 修改 /etc/ssh/sshd_config 的端口、登录选项等信息（建议在配置完成密钥之后关闭密码登录）</span></span></code></pre></div><p>在 <code>/entrypoint.sh</code> 的最上面添加 <code>/usr/sbin/sshd</code>，在重启 docker 的时候会生效。</p><h6 id=方案二gerrit-启动自己的-sshd-使用自己的-sshd_config>方案二：<code>gerrit</code> 启动自己的 sshd 使用自己的 <code>sshd_config</code></h6><p>当我们安装 Gerrit 在物理机器上时，可以由 <code>gerrit</code> 用户自己启动一个 <code>sshd</code>，</p><div class=sourceCode id=cb9><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb9-1><a href=#cb9-1 aria-hidden=true></a><span class=fu>su</span> gerrit <span class=co># 切换到 gerrit 用户</span></span>
<span id=cb9-2><a href=#cb9-2 aria-hidden=true></a><span class=fu>mkdir</span> -p ~/.ssh/etc/ssh</span>
<span id=cb9-3><a href=#cb9-3 aria-hidden=true></a><span class=fu>ssh-keygen</span> -A -f ~/.ssh</span>
<span id=cb9-4><a href=#cb9-4 aria-hidden=true></a><span class=fu>mv</span> ~/.ssh/etc/ssh/sshd_host* ~/.ssh</span>
<span id=cb9-5><a href=#cb9-5 aria-hidden=true></a><span class=fu>rmdir</span> --ignore-fail-on-non-empty -p ~/.ssh/etc/ssh</span>
<span id=cb9-6><a href=#cb9-6 aria-hidden=true></a><span class=fu>cp</span> /etc/ssh/sshd_config ~/.ssh/sshd_config</span>
<span id=cb9-7><a href=#cb9-7 aria-hidden=true></a><span class=co># 修改 ~/.ssh/sshd_config 的端口、登录选项等信息（建议在配置完成密钥之后关闭密码登录）</span></span></code></pre></div><p>在 <code>/entrypoint.sh</code> 的最上面添加： <code>/usr/sbin/sshd -f /var/gerrit/.ssh/sshd_config</code>，在重启 docker 的时候会生效。</p><h4 id=配置-replica>配置 replica</h4><p>如果在 Slave 上用 Gerrit 提供服务，需要配置只读，只允许从 master 复制到 slave</p><p>有两种方案，一种是配 <a href=https://gerrit-review.googlesource.com/Documentation/config-gerrit.html#All-Projects-project.config><code>$site_path/etc/All-Projects/project.config</code></a>，可以覆盖 All-Projects.git 中的配置信息，还有一种就是配置 <a href=https://gerrit-review.googlesource.com/Documentation/config-gerrit.html#container.replica><code>$site_path/etc/gerrit.config</code></a> 直接配置 replica，后者更合适。</p><div class=sourceCode id=cb10><pre class="sourceCode ini"><code class="sourceCode ini"><span id=cb10-1><a href=#cb10-1 aria-hidden=true></a><span class=kw>[container]</span></span>
<span id=cb10-2><a href=#cb10-2 aria-hidden=true></a><span class=dt>    replica </span><span class=ot>=</span><span class=st> </span><span class=kw>true</span></span></code></pre></div><div class=sourceCode id=cb11><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb11-1><a href=#cb11-1 aria-hidden=true></a><span class=ex>docker</span> cp --archive gerrit-gerrit-2-1:/var/gerrit/etc/gerrit.config  gerrit2.config</span>
<span id=cb11-2><a href=#cb11-2 aria-hidden=true></a><span class=ex>docker</span> cp --archive gerrit2.config gerrit-gerrit-2-1:/var/gerrit/etc/gerrit.config</span></code></pre></div><ul><li>Tips:</li></ul><p>配置只读之后，ssh 的 <code>gerrit query</code> 等 <code>gerrit</code> 命令就没有了，网页也是 404 了。</p><pre class=console><code>bash-4.4$ ssh -p 29419 admin@192.168.3.55 gerrit query status:open
fatal: gerrit: query: not found</code></pre><h4 id=移走或者删除-all-project.git-和-all-users.git>移走（或者删除） All-Project.git 和 All-Users.git</h4><p>由于我们想做的是全量备份，这两个仓库直接用 master 的配置就好了，所以进入 <code>$site_path/git</code>，将里面所有的仓库移到别处备份（明确的话也可以直接删除）。</p><h4 id=重启-gerrit>重启 Gerrit</h4><p>重启 Gerrit 以生效 <code>/entrypoint.sh</code> 和 <code>gerrit.config</code></p><div class=sourceCode id=cb13><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb13-1><a href=#cb13-1 aria-hidden=true></a><span class=ex>docker</span> restart gerrit-gerrit-2-1</span></code></pre></div><h3 id=master-机的配置>master 机的配置</h3><p>参考 <a href=https://gerrit.googlesource.com/plugins/replication/+doc/master/src/main/resources/Documentation/config.md>Gerrit 官方文档</a></p><p>https://groups.google.com/g/repo-discuss/c/pJHiB1Vki4U</p><h4 id=进入-master-gerrit-1>进入 master Gerrit 1</h4><p>对 master 机器的配置，除特殊说明外均只需普通用户权限</p><div class=sourceCode id=cb14><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb14-1><a href=#cb14-1 aria-hidden=true></a><span class=ex>docker</span> exec -it gerrit-gerrit-2-1 /bin/bash</span></code></pre></div><h4 id=打通-ssh-通讯>打通 ssh 通讯</h4><ol type=1><li>配置 ssh 公钥密钥对，用于无密码传输，Gerrit 要求使用 <code>PEM</code> 的格式</li></ol><div class=sourceCode id=cb15><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb15-1><a href=#cb15-1 aria-hidden=true></a><span class=fu>ssh-keygen</span> -m PEM -t rsa -C <span class=st>&quot;your_email@example.com&quot;</span></span></code></pre></div><ol start=2 type=1><li>将生成的公钥拷至 slave 服务器的本地用户的 <code>~/.ssh/authorized_keys</code> （在我们的例子中就是 <code>/var/gerrit/.ssh/authorized_keys</code>）文件中，详见 <a href=./rsa_ssh/>ssh 免密登录</a></li></ol><p>Tips: 可以加这个前缀 <code>no-port-forwarding,no-X11-forwarding,no-agent-forwarding,no-pty</code></p><ol start=3 type=1><li>手动连接 slave 服务器，以添加 slave 服务器的 fingerprint 到 known_hosts</li></ol><p>Tips: 可以用 <code>ssh_config</code> 来配置细节，另外，在公钥传输完成后，可以将密码登录禁用</p><h4 id=配置-replication.config>配置 <code>replication.config</code></h4><div class=sourceCode id=cb16><pre class="sourceCode ini"><code class="sourceCode ini"><span id=cb16-1><a href=#cb16-1 aria-hidden=true></a><span class=co># $site_path/etc/replication.config</span></span>
<span id=cb16-2><a href=#cb16-2 aria-hidden=true></a><span class=kw>[remote &quot;gerrit-2&quot;]</span></span>
<span id=cb16-3><a href=#cb16-3 aria-hidden=true></a><span class=dt>url </span><span class=ot>=</span><span class=st> ssh://gerrit@&lt;my_host_ip_addr&gt;:</span><span class=dv>22001</span><span class=st>/var/gerrit/git/${name}.git</span></span></code></pre></div><p>这里的 URL 就是 clone 时，或者说 push 时的 URL</p><ul><li><code>&lt;my_host_ip_addr></code>：是 host 机的 IP 地址</li><li><code>22001</code>：是上面 docker 映射出来的内部的 22 号端口，而不是 Gerrit 的端口</li><li><code>/var/gerrit/git/${name}.git</code>：slave 机上的 <code>gerrit</code> 用户看到的仓库路径。</li></ul><h5 id=重载配置>重载配置</h5><p>master 机这里这里也需要添加上面生成的 ssh key 到 Gerrit 的 admin 用户中，当然你也可以使用本地账户。</p><div class=sourceCode id=cb17><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb17-1><a href=#cb17-1 aria-hidden=true></a><span class=co># 在 gerrit-1 内执行（如果用的是本地账户，则在物理机上执行）</span></span>
<span id=cb17-2><a href=#cb17-2 aria-hidden=true></a><span class=fu>ssh</span> -p 29418 admin@127.0.0.1 gerrit plugin reload replication</span></code></pre></div><h3 id=master-触发-replication>master 触发 replication</h3><p>master 机这里用以下命令触发 replication</p><div class=sourceCode id=cb18><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb18-1><a href=#cb18-1 aria-hidden=true></a><span class=fu>ssh</span> -p 29418 admin@127.0.0.1 replication start</span></code></pre></div><h4 id=调试-replication>调试 replication</h4><h5 id=查看-replication-的状态>查看 replication 的状态</h5><div class=sourceCode id=cb19><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb19-1><a href=#cb19-1 aria-hidden=true></a><span class=fu>ssh</span> -p 29418 admin@127.0.0.1 replication list --detail</span></code></pre></div><h5 id=查看-replication-的日志>查看 replication 的日志</h5><pre><code>cd $site_path
cat logs/replication_log  |grep &#39;^\[2025-&#39;</code></pre><h3 id=slave-没有权限>slave 没有权限</h3><p>在重启配置完成后，有可能 ssh 到 slave 的 <code>gerrit</code> 提示 <code>admin@192.168.3.55: Permission denied (publickey).</code>。</p><p>解决方式是把 replica 关掉，进到 Welcome 网页（可以直接在机器上访问 docker 的 IP + 8080 的端口。点 <code>Install plugins</code>，点 <code>Done >> Go To Gerrit</code>。然后重新打开 replica 就可以了。</p><h3 id=slave-重建索引>slave 重建索引</h3><p>如果没有配置 replica，网页上不会刷新更新的仓库，需要用以下命令刷新一下</p><pre><code>ssh -p 22001 gerrit@&lt;my_host_ip_addr&gt; gerrit index start projects --force</code></pre><h2 id=replication-后记>replication 后记</h2><p>对 slave 端如果有 GitHub 等其他可以接收裸 git 的命令的也可以，甚至可能也可以走 Gerrit 提供的端口，只要 Gerrit 端口允许裸推。从我实验的情况来看，Gerrit replication 在连上 slave 服务器时会执行如下命令：</p><pre><code>-c mkdir -p &#39;/srv/git/gerrit/test-repo.git&#39; &amp;&amp; cd &#39;/srv/git/gerrit/test-repo.git&#39; &amp;&amp; git init --bare &amp;&amp; git symbolic-ref HEAD &#39;refs/heads/master&#39;
-c git-upload-pack &#39;/srv/git/gerrit/All-Projects.git&#39;
-c git-receive-pack &#39;/srv/git/gerrit/All-Projects.git&#39;</code></pre></div><div id=Rsidebar><div id=Avatar><img alt=avatar src=/avatar.jpg></div><ul><li><a href=/about>About Me</a></li><li><a href=/donate>Donate Me</a></li><li><a href=/>Ben's Blog</a></li></ul>除非注明，本博客所有文章皆为原创。<br>本作品采用<a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。</div></div><div class=footer><div id=tags><a href=https://bensyz.github.io/blog/tags><i class="fas fa-tags"></i></a>
Keywords:<ul><li><a href=https://bensyz.github.io/blog/tags/Gerrit>Gerrit</a></li><li><a href=https://bensyz.github.io/blog/tags/backup>backup</a></li><li><a href=https://bensyz.github.io/blog/tags/git>git</a></li></ul></div><footer><hr><a href=/>Ben's Blog</a><br>本作品采用<a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。<br><a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33028102001039"><img alt=public_safety_record src=/icons/public_safety_icon.png>浙公网安备 33028102001039号</a>
<a href=https://beian.miit.gov.cn/ target=_blank>浙ICP备2021032097号-1</a></footer></div></div></body></html>