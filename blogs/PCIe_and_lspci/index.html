<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><title>PCIe 和 lspci</title><script src=/js/if_mobile.js></script>
<script>!function(){$("pre > code").each(function(){var s,n=$(this).parent().attr("class");n==null||n===""?$(this).addClass("hljs"):(s={js:"javascript"},s[n]&&(n=s[n]),$(this).addClass(n))})}</script><link rel=stylesheet href=/css/hljs/snazzy.css><link rel=stylesheet href=/css/hljs/line-numbers.min.css><script src=/js/hljs/highlight.min.js></script>
<script src=/js/hljs/highlightjs-line-numbers.min.js></script>
<script>hljs.highlightAll()</script><script>hljs.initLineNumbersOnLoad()</script><link rel=stylesheet href=/css/code.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/footer.css><link rel=stylesheet href=/css/font-awesome.min.css integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin=anonymous><link rel=icon id=light-scheme-icon href=/favicons/favicon_B_Light.ico type=image/x-icon><link rel=icon id=dark-scheme-icon href=/favicons/favicon_B_Dark.ico type=image/x-icon><script src=/js/favicon.js></script></head><body><div class=container><div class=header><h1>PCIe 和 lspci</h1>Wed, 2024-05-08<br>本文最后修改于 Tue, 2024-10-08<hr></div><div class=middle><div id=TitleWithToc><div id=TitleOfToc>PCIe 和 lspci</div></div><div id=content><h2 id=pcie-基础介绍>PCIe 基础介绍</h2><p>Wikipedia 上对 <a href=https://zh.wikipedia.org/wiki/PCI_Express>PCI_Express</a> 的介绍 如下：</p><blockquote><p>Peripheral Component Interconnect Express，简称 PCI-E，官方简称 PCIe，是计算机总线的一个重要分支，它沿用既有的 PCI 编程概念及信号标准，并且构建了更加高速的串行通信系统标准。目前这一标准由 PCI-SIG 组织制定和维护。PCIe 仅应用于内部互连。由于 PCIe 是基于既有的 PCI 系统，所以只需修改物理层而无须修改软件就可将现有 PCI 系统转换为 PCIe。</p></blockquote><h3 id=版本传输通道数和速率>版本、传输通道数和速率</h3><p>我们在买固态硬盘和显卡的时候，经常需要确定 PCIe 的 <strong>版本</strong> 和 <strong>通道数(x几)</strong>，那这两个和速率有什么关系？</p><p>首先，什么是 PCIe 的版本和通道数：</p><ul><li>版本：无疑就是 PCIe 技术迭代之后，速率有了极大地提升。例如：<code>PCIe 3.0</code></li><li>通道数：lane 数，一条 lane 对应两组“差分信号对”，一组差分信号对用于传输 TX，另一组用于传输 RX。由于 PCIe 是串行传输，多条 lane 的数据传输是由 PCIe 上层应用来自行做 IO 多路复用的。例如：<code>x4</code>。</li></ul><p>其次，上边两个参数和速率有什么关系？同一版本，通道数每增一个速率就翻倍。版本每增一个，速率几乎翻倍（除了 PCIe 1.0 到 PCIe 2.0）</p><p>不同版本对应的速率关系：</p><table><thead><tr class=header><th>Version</th><th>Transfer rate per lane(GT/s)</th><th>Line code</th><th>Throughput for <code>x1</code></th></tr></thead><tbody><tr class=odd><td>1.0</td><td>2.5</td><td>8b/10b</td><td><code>2.5 Gib/s*(8b/10b)=2.0 Gib/s=0.250 GiB/s</code></td></tr><tr class=even><td>2.0</td><td>5.0</td><td>8b/10b</td><td><code>5.0 Gib/s*(8b/10b)=4.0 Gib/s=0.500 GiB/s</code></td></tr><tr class=odd><td>3.0</td><td>8.0</td><td>128b/130b</td><td><code>8.0 Gib/s*(128b/130b)=7.88 Gib/s=0.985 GiB/s</code></td></tr><tr class=even><td>4.0</td><td>16.0</td><td>128b/130b</td><td><code>16.0 Gib/s*(128b/130b)=15.753 Gib/s=1.969 GiB/s</code></td></tr><tr class=odd><td>5.0</td><td>32.0</td><td>128b/130b</td><td><code>32.0 Gib/s*(128b/130b)=31.508 Gib/s=3.938 GiB/s</code></td></tr></tbody></table><ul><li>Tips:<ul><li>1 GT/s 表示每秒有 1*10^9 次传输，一次传输传输 1 个bit</li><li>为了避免多个低信号连续传输无法被区分，我们使用 8b/10b 等 Line code 来编码。所以实际传输速率的计算，如最后一列所写：</li></ul></li></ul><p>而通道数的增长就非常简单了，直接对应版本的 <code>x1</code> 的速率上乘几。</p><h3 id=设备类别>设备类别</h3><p>PCIe 是一种信号传输协议，信号的传输必有设备，那么，涉及到 PCIe 信号的设备种类有哪些：</p><table><thead><tr class=header><th>类别</th><th>类似于</th><th>上游信号</th><th>下游信号</th><th>用途</th><th>例子/体现在</th></tr></thead><tbody><tr class=odd><td>Root Complex</td><td>PCIe 主设备</td><td>CPU、内存连接</td><td>下游收发 PCIe 信号。</td><td>主机收发 PCIe 信号</td><td>在主板北桥或 SOC 内部</td></tr><tr class=even><td>Switch</td><td>PCIe hub</td><td>PCIe 信号</td><td>PCIe 信号</td><td>用于扩展 PCIe 口</td><td>在主板北桥</td></tr><tr class=odd><td>Endpoint</td><td>PCIe 从设备</td><td>PCIe 信号</td><td>下游为其他信号</td><td>实际功能设备</td><td>固态硬盘、显卡、RTL8168 网卡芯片</td></tr></tbody></table><ul><li>Tips:<ul><li>Root Complex 中的上游信号: 和 CPU 连接大概是用于发送中断以及 DMA 控制，和内存连接的大概是用于 DMA 数据搬运。</li></ul></li></ul><p>他们的关系<a href=https://en.wikipedia.org/wiki/Root_complex>如图</a>：</p><figure><img src=./figures/Example_PCI_Express_Topology.png alt><figcaption>Example PCI Express Topology</figcaption></figure><h2 id=lspci-介绍><code>lspci</code> 介绍</h2><p>正如开头所说， PCIe 相对于 PCI 只是物理层上发生了变动，上层软件完全一样，所以我们可以使用 <code>lspci</code> 来读取设备上 PCIe 的信息。也就是说虽然 PCIe 没有总线的概念，物理上是点对点协议，但是由于上层软件是兼容的，所以，仍然会有总线的概念。在后面选择设备时会用到总线的概念，但是它只是一个虚的概念。</p><p>我们将用 <code>lspci</code> 命令来获取常见的 <code>PCIe</code> 的信息，主要包括以下几个方面：</p><ol type=1><li>获取设备的总线号和设备号，用于选择设备</li><li>获取 PCIe 插槽/设备的 <em>版本号</em> 和 <em>传输通道数</em></li></ol><h3 id=常用参数>常用参数</h3><ul><li><code>s</code>: select</li><li><code>v</code>: verbose</li><li><code>vv</code>: more verbose</li><li><code>vvv</code>: even more verbose</li><li><code>t</code>: tree view</li></ul><h3 id=选择-pci-设备-lspci--t>选择 PCI 设备（ <code>lspci -t</code>）</h3><h4 id=lspci><code>lspci</code></h4><p>在选择 PCI 设备前，我们先看一下不带任何参数的 <code>lspci</code>，它的输出如下：</p><pre class=console><code>$ lspci
...
03:08.0 PCI bridge: PLX Technology, Inc. PEX 8747 48-Lane, 5-Port PCI Express Gen 3 (8.0 GT/s) Switch (rev ca)
03:10.0 PCI bridge: PLX Technology, Inc. PEX 8747 48-Lane, 5-Port PCI Express Gen 3 (8.0 GT/s) Switch (rev ca)
04:00.0 VGA compatible controller: NVIDIA Corporation GP102 [TITAN X] (rev a1)
04:00.1 Audio device: NVIDIA Corporation GP102 HDMI Audio Controller (rev a1)
05:00.0 VGA compatible controller: NVIDIA Corporation GP102 [TITAN X] (rev a1)
05:00.1 Audio device: NVIDIA Corporation GP102 HDMI Audio Controller (rev a1)
...</code></pre><p>由于 PCIe 借用的 PCI 的软件，因此沿用了 PCI 的这四种属性：<code>domain</code>, <code>bus</code>, <code>device</code>, <code>function</code> 我们可以通过这四个参数确定或者说选择一个 PCI 设备上的一个功能。他们也就是上述输出中的第一列。其中由于 domain number 基本是一样的，为 <code>0</code>，所以这里省略了只有当带上 <code>-t</code> 的时候会看到这个 domain number。完整的定位一个 PCI 设备和功能的格式是：</p><pre><code>domain:bus:device.function</code></pre><p>对于下面这个设备</p><pre><code>04:00.0 VGA compatible controller: NVIDIA Corporation GP102 [TITAN X] (rev a1)
 |  | |
 |  | \- function
 |  \--- device
 \------ bus</code></pre><p>它的各个属性如下：</p><ul><li><code>domain</code>: 0 ( 被省略了 )</li><li><code>bus</code>: 04</li><li><code>device</code>: 00</li><li><code>function</code>: 0</li></ul><h4 id=lspci--s-xx><code>lspci -s xx</code></h4><p>上一节中说到，可以由这个四个属性确定一个 PCI 设备功能。它有什么用呢？当我们使用 <code>vvv</code> 显示更多详细信息而不选择特定设备时，<code>lspci</code> 会反给我们一大串的输出，你会发现太多了，都不知道看哪个，用 <code>-s</code> 来选择一下会对结果输出有极大的简化。对上面那个设备我们可以用以下命令来选择输出：</p><pre class=console><code>$ lspci -s 0:03:08.0
03:08.0 PCI bridge: PLX Technology, Inc. PEX 8747 48-Lane, 5-Port PCI Express Gen 3 (8.0 GT/s) Switch (rev ca)
$ lspci -s 03:08.0
03:08.0 PCI bridge: PLX Technology, Inc. PEX 8747 48-Lane, 5-Port PCI Express Gen 3 (8.0 GT/s) Switch (rev ca)</code></pre><p>你可以用 <code>-vvv</code> 来输出更多详细信息。我们会在读取 PCIe 版本和带宽的时候用到这个参数。</p><h3 id=pcie-树状结构的输出解析确定设备和槽-lspci--t>PCIe 树状结构的输出解析，确定设备和槽（ <code>lspci -t</code>）</h3><p><code>lspci -t</code> 给出的树状结构表示的是它的物理连接方式（ <code>bus</code> 是虚拟的含义），我们可以通过它来查询一个 PCIe 外设是插在哪个 PCIe 的槽上，当我们要扩容，或者要替换外设时，我们需要选择版本、通道匹配的 PCI 外设，我们可以通过这个命令来查看 PCIe 槽最大支持的版本和通道数，避免不匹配带来的性能缺失。同时，我们将看到 <code>domain</code>, <code>bus</code>, <code>device</code>, <code>function</code> 属性在树状结构中的表示。</p><p>以下是 <code>lspci -tv</code> 的输出：</p><pre class=console><code>$ lspci -tv
-+-[0000:ff]-+-08.0  Intel Corporation Xeon E7 v4/Xeon E5 v4/Xeon E3 v4/Xeon D QPI Link 0
 |           +-...
 \-[0000:00]-+-00.0  Intel Corporation Xeon E7 v4/Xeon E5 v4/Xeon E3 v4/Xeon D DMI2
             +-01.0-[01]--
             +-02.0-[02-05]----00.0-[03-05]--+-08.0-[04]--+-00.0  NVIDIA Corporation GP102 [TITAN X]
             |                               |            \-00.1  NVIDIA Corporation GP102 HDMI Audio Controller
             |                               \-10.0-[05]--+-00.0  NVIDIA Corporation GP102 [TITAN X]
             |                                            \-00.1  NVIDIA Corporation GP102 HDMI Audio Controller
             +-03.0-[06-09]----00.0-[07-09]--+-08.0-[08]--+-00.0  NVIDIA Corporation GP102 [TITAN X]
             |                               |            \-00.1  NVIDIA Corporation GP102 HDMI Audio Controller
             |                               \-10.0-[09]--+-00.0  NVIDIA Corporation GP102 [TITAN X]
             |                                            \-00.1  NVIDIA Corporation GP102 HDMI Audio Controller
             +-05.0  Intel Corporation Xeon E7 v4/Xeon E5 v4/Xeon E3 v4/Xeon D Map/VTd_Misc/System Management
             +-...</code></pre><p>在 <code>lspci -t</code> 中，domain 和 bus 被用中括号包裹起来，例如第一行的 <code>[0000:ff]</code> 表示 domain 为 0000，bus 为 ff。</p><p>我们来一点一点看一下这棵子树</p><pre><code>-+-
 \-[0000:00]-+
             +
             +-02.0-[02-05]----00.0-[03-05]--+-08.0-[04]--+-00.0  NVIDIA Corporation GP102 [TITAN X]
                                             |            \-00.1  NVIDIA Corporation GP102 HDMI Audio Controller
                                             \-10.0-[05]--+-00.0  NVIDIA Corporation GP102 [TITAN X]
                                                          \-00.1  NVIDIA Corporation GP102 HDMI Audio Controller</code></pre><ul><li><code>[0000:00]</code>:<ul><li>domain: 0000</li><li>bus: 00</li></ul></li><li><code>[0000:00]-+-02.0-[02-05]----00.0-[03-05]--+-08.0-[04]--+-00.0</code><ul><li><code>[0000:00]-+-02.0-[02-05]</code><ul><li><code>[0000:00]-+-02.0</code><ul><li>02 的设备挂在 <code>[0000:00]</code>，即它的“索引”是 <strong><code>00:02</code></strong></li></ul></li><li><code>02.0-[02-05]</code><ul><li>02-05 (即 02、03、04、05) 这些 bus 挂在 <code>00:02</code> 这个设备的 <code>.0</code> 功能上</li></ul></li></ul></li><li><code>[02-05]----00.0-[03-05]</code><ul><li><code>[02-05]----00.0</code><ul><li><code>00</code> 这个设备挂在 bus 02 上，（03-05 bus 号是给后续的桥用的），即它的“索引”是 <strong><code>02:00</code></strong></li></ul></li><li><code>00.0-[03-05]</code><ul><li>03-05 (即 03、04、05) 这些 bus 挂在 <code>02:00</code> 这个设备的 <code>.0</code> 功能上</li></ul></li></ul></li><li><code>[03-05]--+-08.0-[04]</code><ul><li><code>[03-05]--+-08.0</code><ul><li><code>08</code> 这个设备挂在 bus 03 上，（04 05 bus 号是给后续的桥用的），即它的“索引”是 <strong><code>03:08</code></strong></li></ul></li><li><code>08.0-[04]</code><ul><li>04 bus 挂在 <code>03:08</code> 这个设备的 <code>.0</code> 功能上</li></ul></li></ul></li><li><code>[04]--+-00.0</code><ul><li><code>00</code> 这个设备挂在 bus 04 上，即它的“索引”是 <strong><code>04:00</code></strong>，也就是 <code>GP102 [TITAN X]</code> 显卡</li></ul></li><li><code>00.0</code> 和 <code>00.1</code> 是 <code>GP102 [TITAN X]</code> 显卡的两个 Function</li></ul></li></ul><p>为了不让上述的解析过长，我将上述涉及的设备列在这里，可以通过 <code>lspci -s</code>，来选择输出</p><pre><code>00:02.0 PCI bridge: Intel Corporation Xeon E7 v4/Xeon E5 v4/Xeon E3 v4/Xeon D PCI Express Root Port 2 (rev 01) -&gt; 它是一个 Root Complex。
02:00.0 PCI bridge: PLX Technology, Inc. PEX 8747 48-Lane, 5-Port PCI Express Gen 3 (8.0 GT/s) Switch (rev ca) -&gt; 它是一个 switch。
03:08.0 PCI bridge: PLX Technology, Inc. PEX 8747 48-Lane, 5-Port PCI Express Gen 3 (8.0 GT/s) Switch (rev ca) -&gt; 它是一个 switch。
04:00.0 VGA compatible controller: NVIDIA Corporation GP102 [TITAN X] (rev a1)                                 -&gt; 显卡的 VGA 功能
04:00.1 Audio device: NVIDIA Corporation GP102 HDMI Audio Controller (rev a1)                                  -&gt; 显卡的 HDMI 功能</code></pre><p>所以回到本节开头的问题，<code>04:00</code> 的显卡插在哪个 PCIe 槽上呢？<code>03:08.0</code> 这个 switch 芯片上。</p><h3 id=获取-pci-设备的详细信息>获取 PCI 设备的详细信息</h3><p>终于到了获取 PCI 设备速率的时候了，我们将查看 <code>04:00</code> 显卡和 <code>03:08.0</code> 插槽，注意 Capabilities 信息需要 root 来读取。以下是 <code>03:08.0</code> 和 <code>04:00</code> 的完整输出。</p><pre class=console><code># lspci -vvv -s 03:08.0
03:08.0 PCI bridge: PLX Technology, Inc. PEX 8747 48-Lane, 5-Port PCI Express Gen 3 (8.0 GT/s) Switch (rev ca) (prog-if 00 [Normal decode])
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B- DisINTx+
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Latency: 0, Cache Line Size: 32 bytes
        Interrupt: pin A routed to IRQ 34
        NUMA node: 0
        Bus: primary=03, secondary=04, subordinate=04, sec-latency=0
        I/O behind bridge: 00006000-00006fff [size=4K]
        Memory behind bridge: c4000000-c50fffff [size=17M]
        Prefetchable memory behind bridge: 0000033fe0000000-0000033ff1ffffff [size=288M]
        Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &lt;SERR- &lt;PERR-
        BridgeCtl: Parity- SERR+ NoISA- VGA- VGA16+ MAbort- &gt;Reset- FastB2B-
                PriDiscTmr- SecDiscTmr- DiscTmrStat- DiscTmrSERREn-
        Capabilities: [40] Power Management version 3
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0+,D1-,D2-,D3hot+,D3cold+)
                Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [48] MSI: Enable+ Count=1/8 Maskable+ 64bit+
                Address: 00000000fee00000  Data: 40ef
                Masking: 000000ff  Pending: 00000000
        Capabilities: [68] Express (v2) Downstream Port (Slot+), MSI 00
                DevCap: MaxPayload 2048 bytes, PhantFunc 0
                        ExtTag- RBE+
                DevCtl: CorrErr- NonFatalErr- FatalErr- UnsupReq-
                        RlxdOrd- ExtTag- PhantFunc- AuxPwr- NoSnoop+
                        MaxPayload 256 bytes, MaxReadReq 128 bytes
                DevSta: CorrErr+ NonFatalErr- FatalErr- UnsupReq+ AuxPwr- TransPend-
                LnkCap: Port #8, Speed 8GT/s, Width x16, ASPM L1, Exit Latency L1 &lt;4us
                        ClockPM- Surprise+ LLActRep+ BwNot+ ASPMOptComp+
                LnkCtl: ASPM L1 Enabled; Disabled- CommClk-
                        ExtSynch- ClockPM- AutWidDis- BWInt- AutBWInt-
                LnkSta: Speed 8GT/s (ok), Width x16 (ok)
                        TrErr- Train- SlotClk- DLActive+ BWMgmt- ABWMgmt+
                SltCap: AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug- Surprise-
                        Slot #8, PowerLimit 25.000W; Interlock- NoCompl-
                SltCtl: Enable: AttnBtn- PwrFlt- MRL- PresDet- CmdCplt- HPIrq- LinkChg-
                        Control: AttnInd Unknown, PwrInd Unknown, Power- Interlock-
                SltSta: Status: AttnBtn- PowerFlt- MRL- CmdCplt- PresDet+ Interlock-
                        Changed: MRL- PresDet- LinkState-
                DevCap2: Completion Timeout: Not Supported, TimeoutDis-, NROPrPrP-, LTR+
                         10BitTagComp-, 10BitTagReq-, OBFF Via message, ExtFmt-, EETLPPrefix-
                         EmergencyPowerReduction Not Supported, EmergencyPowerReductionInit-
                         FRS-, ARIFwd+
                         AtomicOpsCap: Routing+
                DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled ARIFwd-
                         AtomicOpsCtl: EgressBlck-
                LnkCtl2: Target Link Speed: 8GT/s, EnterCompliance- SpeedDis-, Selectable De-emphasis: -6dB
                         Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-
                         Compliance De-emphasis: -6dB
                LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete+, EqualizationPhase1+
                         EqualizationPhase2+, EqualizationPhase3+, LinkEqualizationRequest-
        Capabilities: [a4] Subsystem: PLX Technology, Inc. PEX 8747 48-Lane, 5-Port PCI Express Gen 3 (8.0 GT/s) Switch
        Capabilities: [100 v1] Vendor Specific Information: ID=0000 Rev=0 Len=000 &lt;?&gt;
        Capabilities: [fb4 v1] Advanced Error Reporting
                UESta:  DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-
                UEMsk:  DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-
                UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol-
                CESta:  RxErr- BadTLP- BadDLLP- Rollover- Timeout- AdvNonFatalErr-
                CEMsk:  RxErr- BadTLP- BadDLLP- Rollover- Timeout- AdvNonFatalErr+
                AERCap: First Error Pointer: 1f, ECRCGenCap+ ECRCGenEn- ECRCChkCap+ ECRCChkEn-
                        MultHdrRecCap- MultHdrRecEn- TLPPfxPres- HdrLogCap-
                HeaderLog: 00000000 00000000 00000000 00000000
        Capabilities: [138 v1] Power Budgeting &lt;?&gt;
        Capabilities: [10c v1] Secondary PCI Express
                LnkCtl3: LnkEquIntrruptEn-, PerformEqu-
                LaneErrStat: 0
        Capabilities: [148 v1] Virtual Channel
                Caps:   LPEVC=0 RefClk=100ns PATEntryBits=8
                Arb:    Fixed- WRR32- WRR64- WRR128-
                Ctrl:   ArbSelect=Fixed
                Status: InProgress-
                VC0:    Caps:   PATOffset=03 MaxTimeSlots=1 RejSnoopTrans-
                        Arb:    Fixed- WRR32- WRR64+ WRR128- TWRR128- WRR256-
                        Ctrl:   Enable+ ID=0 ArbSelect=WRR64 TC/VC=01
                        Status: NegoPending- InProgress-
                        Port Arbitration Table &lt;?&gt;
        Capabilities: [e00 v1] Multicast
                McastCap: MaxGroups 64, ECRCRegen+
                McastCtl: NumGroups 1, Enable-
                McastBAR: IndexPos 0, BaseAddr 0000000000000000
                McastReceiveVec:      0000000000000000
                McastBlockAllVec:     0000000000000000
                McastBlockUntransVec: 0000000000000000
                McastOverlayBAR: OverlaySize 0 (disabled), BaseAddr 0000000000000000
        Capabilities: [f24 v1] Access Control Services
                ACSCap: SrcValid+ TransBlk+ ReqRedir+ CmpltRedir+ UpstreamFwd+ EgressCtrl+ DirectTrans+
                ACSCtl: SrcValid- TransBlk- ReqRedir- CmpltRedir- UpstreamFwd- EgressCtrl- DirectTrans-
        Capabilities: [b70 v1] Vendor Specific Information: ID=0001 Rev=0 Len=010 &lt;?&gt;
        Kernel driver in use: pcieport

# lspci -vvv -s 04:00
04:00.0 VGA compatible controller: NVIDIA Corporation GP102 [TITAN X] (rev a1) (prog-if 00 [VGA controller])
        Subsystem: NVIDIA Corporation GP102 [TITAN X]
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B- DisINTx+
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Latency: 0
        Interrupt: pin A routed to IRQ 103
        NUMA node: 0
        Region 0: Memory at c4000000 (32-bit, non-prefetchable) [size=16M]
        Region 1: Memory at 33fe0000000 (64-bit, prefetchable) [size=256M]
        Region 3: Memory at 33ff0000000 (64-bit, prefetchable) [size=32M]
        Region 5: I/O ports at 6000 [size=128]
        Expansion ROM at c5000000 [virtual] [disabled] [size=512K]
        Capabilities: [60] Power Management version 3
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-)
                Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [68] MSI: Enable+ Count=1/1 Maskable- 64bit+
                Address: 00000000fee00000  Data: 4022
        Capabilities: [78] Express (v2) Legacy Endpoint, MSI 00
                DevCap: MaxPayload 256 bytes, PhantFunc 0, Latency L0s unlimited, L1 &lt;64us
                        ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset-
                DevCtl: CorrErr- NonFatalErr- FatalErr- UnsupReq-
                        RlxdOrd+ ExtTag+ PhantFunc- AuxPwr- NoSnoop+
                        MaxPayload 256 bytes, MaxReadReq 512 bytes
                DevSta: CorrErr- NonFatalErr- FatalErr- UnsupReq- AuxPwr- TransPend-
                LnkCap: Port #8, Speed 8GT/s, Width x16, ASPM L0s L1, Exit Latency L0s &lt;1us, L1 &lt;4us
                        ClockPM+ Surprise- LLActRep- BwNot- ASPMOptComp+
                LnkCtl: ASPM Disabled; RCB 64 bytes Disabled- CommClk-
                        ExtSynch- ClockPM+ AutWidDis- BWInt- AutBWInt-
                LnkSta: Speed 8GT/s (ok), Width x16 (ok)
                        TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-
                DevCap2: Completion Timeout: Range AB, TimeoutDis+, NROPrPrP-, LTR-
                         10BitTagComp-, 10BitTagReq-, OBFF Via message, ExtFmt-, EETLPPrefix-
                         EmergencyPowerReduction Not Supported, EmergencyPowerReductionInit-
                         FRS-
                         AtomicOpsCap: 32bit- 64bit- 128bitCAS-
                DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled
                         AtomicOpsCtl: ReqEn-
                LnkCtl2: Target Link Speed: 8GT/s, EnterCompliance- SpeedDis-
                         Transmit Margin: Normal Operating Range, EnterModifiedCompliance- ComplianceSOS-
                         Compliance De-emphasis: -6dB
                LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete+, EqualizationPhase1+
                         EqualizationPhase2+, EqualizationPhase3+, LinkEqualizationRequest-
        Capabilities: [100 v1] Virtual Channel
                Caps:   LPEVC=0 RefClk=100ns PATEntryBits=1
                Arb:    Fixed- WRR32- WRR64- WRR128-
                Ctrl:   ArbSelect=Fixed
                Status: InProgress-
                VC0:    Caps:   PATOffset=00 MaxTimeSlots=1 RejSnoopTrans-
                        Arb:    Fixed- WRR32- WRR64- WRR128- TWRR128- WRR256-
                        Ctrl:   Enable+ ID=0 ArbSelect=Fixed TC/VC=01
                        Status: NegoPending- InProgress-
        Capabilities: [128 v1] Power Budgeting &lt;?&gt;
        Capabilities: [420 v2] Advanced Error Reporting
                UESta:  DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-
                UEMsk:  DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-
                UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol-
                CESta:  RxErr- BadTLP- BadDLLP- Rollover- Timeout- AdvNonFatalErr-
                CEMsk:  RxErr- BadTLP- BadDLLP- Rollover- Timeout- AdvNonFatalErr+
                AERCap: First Error Pointer: 00, ECRCGenCap- ECRCGenEn- ECRCChkCap- ECRCChkEn-
                        MultHdrRecCap- MultHdrRecEn- TLPPfxPres- HdrLogCap-
                HeaderLog: 00000000 00000000 00000000 00000000
        Capabilities: [600 v1] Vendor Specific Information: ID=0001 Rev=1 Len=024 &lt;?&gt;
        Capabilities: [900 v1] Secondary PCI Express
                LnkCtl3: LnkEquIntrruptEn-, PerformEqu-
                LaneErrStat: 0
        Kernel driver in use: nvidia
        Kernel modules: nvidiafb, nouveau, nvidia_drm, nvidia

04:00.1 Audio device: NVIDIA Corporation GP102 HDMI Audio Controller (rev a1)
        Subsystem: NVIDIA Corporation GP102 HDMI Audio Controller
        Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B- DisINTx-
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Latency: 0, Cache Line Size: 32 bytes
        Interrupt: pin B routed to IRQ 101
        NUMA node: 0
        Region 0: Memory at c5080000 (32-bit, non-prefetchable) [size=16K]
        Capabilities: [60] Power Management version 3
                Flags: PMEClk- DSI- D1- D2- AuxCurrent=0mA PME(D0-,D1-,D2-,D3hot-,D3cold-)
                Status: D0 NoSoftRst+ PME-Enable- DSel=0 DScale=0 PME-
        Capabilities: [68] MSI: Enable- Count=1/1 Maskable- 64bit+
                Address: 0000000000000000  Data: 0000
        Capabilities: [78] Express (v2) Endpoint, MSI 00
                DevCap: MaxPayload 256 bytes, PhantFunc 0, Latency L0s unlimited, L1 &lt;64us
                        ExtTag+ AttnBtn- AttnInd- PwrInd- RBE+ FLReset- SlotPowerLimit 25.000W
                DevCtl: CorrErr- NonFatalErr- FatalErr- UnsupReq-
                        RlxdOrd- ExtTag+ PhantFunc- AuxPwr- NoSnoop+
                        MaxPayload 256 bytes, MaxReadReq 512 bytes
                DevSta: CorrErr+ NonFatalErr- FatalErr- UnsupReq+ AuxPwr- TransPend-
                LnkCap: Port #8, Speed 8GT/s, Width x16, ASPM L0s L1, Exit Latency L0s &lt;1us, L1 &lt;4us
                        ClockPM+ Surprise- LLActRep- BwNot- ASPMOptComp+
                LnkCtl: ASPM L0s L1 Enabled; RCB 64 bytes Disabled- CommClk-
                        ExtSynch- ClockPM+ AutWidDis- BWInt- AutBWInt-
                LnkSta: Speed 8GT/s (ok), Width x16 (ok)
                        TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-
                DevCap2: Completion Timeout: Range AB, TimeoutDis+, NROPrPrP-, LTR-
                         10BitTagComp-, 10BitTagReq-, OBFF Via message, ExtFmt-, EETLPPrefix-
                         EmergencyPowerReduction Not Supported, EmergencyPowerReductionInit-
                         FRS-, TPHComp-, ExtTPHComp-
                         AtomicOpsCap: 32bit- 64bit- 128bitCAS-
                DevCtl2: Completion Timeout: 50us to 50ms, TimeoutDis-, LTR-, OBFF Disabled
                         AtomicOpsCtl: ReqEn-
                LnkSta2: Current De-emphasis Level: -6dB, EqualizationComplete-, EqualizationPhase1-
                         EqualizationPhase2-, EqualizationPhase3-, LinkEqualizationRequest-
        Capabilities: [100 v2] Advanced Error Reporting
                UESta:  DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-
                UEMsk:  DLP- SDES- TLP- FCP- CmpltTO- CmpltAbrt- UnxCmplt- RxOF- MalfTLP- ECRC- UnsupReq- ACSViol-
                UESvrt: DLP+ SDES+ TLP- FCP+ CmpltTO- CmpltAbrt- UnxCmplt- RxOF+ MalfTLP+ ECRC- UnsupReq- ACSViol-
                CESta:  RxErr- BadTLP- BadDLLP- Rollover- Timeout- AdvNonFatalErr-
                CEMsk:  RxErr- BadTLP- BadDLLP- Rollover- Timeout- AdvNonFatalErr+
                AERCap: First Error Pointer: 00, ECRCGenCap- ECRCGenEn- ECRCChkCap- ECRCChkEn-
                        MultHdrRecCap- MultHdrRecEn- TLPPfxPres- HdrLogCap-
                HeaderLog: 00000000 00000000 00000000 00000000
        Kernel driver in use: snd_hda_intel
        Kernel modules: snd_hda_intel</code></pre><p>输出有点多，我们先看一层一层来看，第一层的输出：</p><pre class=console><code>03:08.0 PCI bridge: PLX Technology, Inc. PEX 8747 48-Lane, 5-Port PCI Express Gen 3 (8.0 GT/s) Switch (rev ca) (prog-if 00 [Normal decode])
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B- DisINTx+
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Latency: 0, Cache Line Size: 32 bytes
        Interrupt: pin A routed to IRQ 34
        NUMA node: 0
        Bus: primary=03, secondary=04, subordinate=04, sec-latency=0
        I/O behind bridge: 00006000-00006fff [size=4K]
        Memory behind bridge: c4000000-c50fffff [size=17M]
        Prefetchable memory behind bridge: 0000033fe0000000-0000033ff1ffffff [size=288M]
        Secondary status: 66MHz- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &lt;SERR- &lt;PERR-
        BridgeCtl: Parity- SERR+ NoISA- VGA- VGA16+ MAbort- &gt;Reset- FastB2B-
        Capabilities: [40] Power Management version 3
        Capabilities: [48] MSI: Enable+ Count=1/8 Maskable+ 64bit+
        Capabilities: [68] Express (v2) Downstream Port (Slot+), MSI 00
        Capabilities: [a4] Subsystem: PLX Technology, Inc. PEX 8747 48-Lane, 5-Port PCI Express Gen 3 (8.0 GT/s) Switch
        Capabilities: [100 v1] Vendor Specific Information: ID=0000 Rev=0 Len=000 &lt;?&gt;
        Capabilities: [fb4 v1] Advanced Error Reporting
        Capabilities: [138 v1] Power Budgeting &lt;?&gt;
        Capabilities: [10c v1] Secondary PCI Express
        Capabilities: [148 v1] Virtual Channel
        Capabilities: [e00 v1] Multicast
        Capabilities: [f24 v1] Access Control Services
        Capabilities: [b70 v1] Vendor Specific Information: ID=0001 Rev=0 Len=010 &lt;?&gt;
        Kernel driver in use: pcieport

# lspci -vvv -s 04:00
04:00.0 VGA compatible controller: NVIDIA Corporation GP102 [TITAN X] (rev a1) (prog-if 00 [VGA controller])
        Subsystem: NVIDIA Corporation GP102 [TITAN X]
        Control: I/O+ Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B- DisINTx+
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Latency: 0
        Interrupt: pin A routed to IRQ 103
        NUMA node: 0
        Region 0: Memory at c4000000 (32-bit, non-prefetchable) [size=16M]
        Region 1: Memory at 33fe0000000 (64-bit, prefetchable) [size=256M]
        Region 3: Memory at 33ff0000000 (64-bit, prefetchable) [size=32M]
        Region 5: I/O ports at 6000 [size=128]
        Expansion ROM at c5000000 [virtual] [disabled] [size=512K]
        Capabilities: [60] Power Management version 3
        Capabilities: [68] MSI: Enable+ Count=1/1 Maskable- 64bit+
        Capabilities: [78] Express (v2) Legacy Endpoint, MSI 00
        Capabilities: [100 v1] Virtual Channel
        Capabilities: [128 v1] Power Budgeting &lt;?&gt;
        Capabilities: [420 v2] Advanced Error Reporting
        Capabilities: [600 v1] Vendor Specific Information: ID=0001 Rev=1 Len=024 &lt;?&gt;
        Capabilities: [900 v1] Secondary PCI Express
        Kernel driver in use: nvidia
        Kernel modules: nvidiafb, nouveau, nvidia_drm, nvidia

04:00.1 Audio device: NVIDIA Corporation GP102 HDMI Audio Controller (rev a1)
        Subsystem: NVIDIA Corporation GP102 HDMI Audio Controller
        Control: I/O- Mem+ BusMaster+ SpecCycle- MemWINV- VGASnoop- ParErr- Stepping- SERR+ FastB2B- DisINTx-
        Status: Cap+ 66MHz- UDF- FastB2B- ParErr- DEVSEL=fast &gt;TAbort- &lt;TAbort- &lt;MAbort- &gt;SERR- &lt;PERR- INTx-
        Latency: 0, Cache Line Size: 32 bytes
        Interrupt: pin B routed to IRQ 101
        NUMA node: 0
        Region 0: Memory at c5080000 (32-bit, non-prefetchable) [size=16K]
        Capabilities: [60] Power Management version 3
        Capabilities: [68] MSI: Enable- Count=1/1 Maskable- 64bit+
        Capabilities: [78] Express (v2) Endpoint, MSI 00
        Capabilities: [100 v2] Advanced Error Reporting
        Kernel driver in use: snd_hda_intel
        Kernel modules: snd_hda_intel</code></pre><p>目前我看得懂的，或者说我常用的属性是以下几个：</p><p><code>Subsystem</code>：属于什么子系统 <code>Status</code>：状态，是否有错 <code>Interrupt</code>：中断信息 <code>Region</code>: 内存映射 <code>Capabilities</code>：能力，包括 MSI，Express <code>Kernel driver in use</code>：正在使用的驱动 <code>Kernel modules</code>：可用的驱动</p><p>其中最有用的 Capabilities，<code>lspci</code> 毕竟是列出 PCI 设备，那我们如何确定设备是 PCIe 设备呢？看 Capabilities 中是否有 Express，这个 PCI 设备有 Express 的能力，也就是说它是 PCIe 设备。那么我们要查看的速率和版本也在这个属性下面。</p><h4 id=获取-pcie-设备的版本和传输通道数>获取 PCIe 设备的版本和传输通道数</h4><p>我们在 <code>Capabilities: Express (v2) Endpoint, MSI 00</code> 属性下面可以找两个属性：<code>LnkCap</code> 和 <code>LnkSta</code>，前者表示该设备支持的能力（Link Capability），后者是这个设备的连接状态（Link State)。我们可以从 <code>LnkCap</code> 属性上看到下面这两个设备的“单个传输通道数”的速率都是 8GT/s，传输通道数是 <code>x16</code>，也就是说这两个设备是 <code>PCIe 3.0 x16</code> 的。</p><pre><code># tree view(partial)
-[0000:00]-+-02.0-[02-05]----00.0-[03-05]--+-08.0-[04]--+-00.0  NVIDIA Corporation GP102 [TITAN X]
                                                        \-00.1  NVIDIA Corporation GP102 HDMI Audio Controller

# verbose output(partial)
03:08.0 PCI bridge: PLX Technology, Inc. PEX 8747 48-Lane, 5-Port PCI Express Gen 3 (8.0 GT/s) Switch (rev ca) (prog-if 00 [Normal decode])
        Capabilities: [68] Express (v2) Downstream Port (Slot+), MSI 00
                LnkCap: Port #8, Speed 8GT/s, Width x16, ASPM L1, Exit Latency L1 &lt;4us
                        ClockPM- Surprise+ LLActRep+ BwNot+ ASPMOptComp+
                LnkSta: Speed 8GT/s (ok), Width x16 (ok)
                        TrErr- Train- SlotClk- DLActive+ BWMgmt- ABWMgmt+
04:00.0 VGA compatible controller: NVIDIA Corporation GP102 [TITAN X] (rev a1) (prog-if 00 [VGA controller])
        Subsystem: NVIDIA Corporation GP102 [TITAN X]
        Capabilities: [78] Express (v2) Legacy Endpoint, MSI 00
                LnkCap: Port #8, Speed 8GT/s, Width x16, ASPM L0s L1, Exit Latency L0s &lt;1us, L1 &lt;4us
                        ClockPM+ Surprise- LLActRep- BwNot- ASPMOptComp+
                LnkSta: Speed 8GT/s (ok), Width x16 (ok)
                        TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-
04:00.1 Audio device: NVIDIA Corporation GP102 HDMI Audio Controller (rev a1)
        Subsystem: NVIDIA Corporation GP102 HDMI Audio Controller
        Capabilities: [78] Express (v2) Endpoint, MSI 00
                LnkCap: Port #8, Speed 8GT/s, Width x16, ASPM L0s L1, Exit Latency L0s &lt;1us, L1 &lt;4us
                        ClockPM+ Surprise- LLActRep- BwNot- ASPMOptComp+
                LnkSta: Speed 8GT/s (ok), Width x16 (ok)
                        TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-</code></pre><ul><li>Tips：<ul><li>我猜测，一个设备的两个功能对应的版本和传输通道数是一样的。（可能插槽会有区别？我不是很确定，或者说，我们需要明确的是 function 是什么东西，TODO）</li><li>还有一些是 PCIe 设备 training（类似自协商）时会用的属性，例如 <code>LnkCtl2</code>, <code>LnkSta2</code>。</li><li>这些属性本质其实是 PCIe 配置空间内，寄存器的值。</li></ul></li></ul><p>由于插槽和设备的能力不匹配，实际的连接状态 <code>LnkSta</code> 和设备的能力 <code>LnkCap</code> 会不一样。我们可以在 <code>LnkSta</code> 中查看当前连接状态，可以看到上面这台设备 <code>LnkSta</code> 中的 Speed 和 Width 和 <code>LnkCap</code> 中的一样，因此，速率是匹配的，设备的性能可以得到完全发挥，<code>lspci</code> 也很贴心地标注了两个 <code>ok</code>。但是下面这台设备，速率就不匹配了我们可以看到固态硬盘（<code>03:00</code>）设备支持的速率是 <code>8GT/s x4</code>（<code>PCIe 3.0 x4</code>），而插槽（<code>00:1d.0</code>）支持的速率是 <code>8GT/s x2</code>（<code>PCIe 3.0 x2</code>），因此，固态硬盘的性能得不到完全的发挥。同时，我们可以看到设备的 <code>LnkSta</code> 下对应有问题的属性边上标注了 <code>downgraded</code>。</p><pre><code># tree view(partial)
-[0000:00]-+-1d.0-[03]----00.0  Silicon Motion, Inc. SM2262/SM2262EN SSD Controller

# verbose output(partial)
00:1d.0 PCI bridge: Intel Corporation Sunrise Point-LP PCI Express Root Port #9 (rev f1) (prog-if 00 [Normal decode])
        Subsystem: Lenovo Device 505b
        Capabilities: [40] Express (v2) Root Port (Slot+), IntMsgNum 0
                LnkCap: Port #9, Speed 8GT/s, Width x2, ASPM L1, Exit Latency L1 &lt;16us
                        ClockPM- Surprise- LLActRep+ BwNot+ ASPMOptComp+
                LnkSta: Speed 8GT/s, Width x2
                        TrErr- Train- SlotClk+ DLActive+ BWMgmt+ ABWMgmt-
        Kernel driver in use: pcieport
03:00.0 Non-Volatile memory controller: Silicon Motion, Inc. SM2262/SM2262EN SSD Controller (rev 03) (prog-if 02 [NVM Express])
        Subsystem: Silicon Motion, Inc. SM2262/SM2262EN SSD Controller
        Capabilities: [70] Express (v2) Endpoint, IntMsgNum 0
                LnkCap: Port #0, Speed 8GT/s, Width x4, ASPM L1, Exit Latency L1 &lt;8us
                        ClockPM+ Surprise- LLActRep- BwNot- ASPMOptComp+
                LnkSta: Speed 8GT/s, Width x2 (downgraded)
                        TrErr- Train- SlotClk+ DLActive- BWMgmt- ABWMgmt-</code></pre><p>至此，我们已经介绍了 PCIe 的基础知识以及如何使用 <code>lspci</code> 查询 PCIe 设备的属性，快去看看你的 Linux 下的 PCIe 系统吧，看看有什么可以改进和升级的。</p></div><div id=Rsidebar><div id=Avatar><img alt=avatar src=/avatar.jpg></div><ul><li><a href=/about>About Me</a></li><li><a href=/donate>Donate Me</a></li><li><a href=/>Ben's Blog</a></li></ul>除非注明，本博客所有文章皆为原创。<br>本作品采用<a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。</div></div><div class=footer><div id=tags><a href=https://bensyz.github.io/blog/tags><i class="fas fa-tags"></i></a>
Keywords:<ul><li><a href=https://bensyz.github.io/blog/tags/Linux>Linux</a></li><li><a href=https://bensyz.github.io/blog/tags/lspci>lspci</a></li><li><a href=https://bensyz.github.io/blog/tags/PCIe>PCIe</a></li></ul></div><footer><hr><a href=/>Ben's Blog</a><br>本作品采用<a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。<br><a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33028102001039"><img alt=public_safety_record src=/icons/public_safety_icon.png>浙公网安备 33028102001039号</a>
<a href=https://beian.miit.gov.cn/ target=_blank>浙ICP备2021032097号-1</a></footer></div></div></body></html>