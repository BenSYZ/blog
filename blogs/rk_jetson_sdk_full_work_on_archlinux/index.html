<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><title>RK and Jetson SDK full work on ArchLinux</title><script src=/js/if_mobile.js></script>
<script>!function(){$("pre > code").each(function(){var s,n=$(this).parent().attr("class");n==null||n===""?$(this).addClass("hljs"):(s={js:"javascript"},s[n]&&(n=s[n]),$(this).addClass(n))})}</script><link rel=stylesheet href=/css/hljs/snazzy.css><link rel=stylesheet href=/css/hljs/line-numbers.min.css><script src=/js/hljs/highlight.min.js></script>
<script src=/js/hljs/highlightjs-line-numbers.min.js></script>
<script>hljs.highlightAll()</script><script>hljs.initLineNumbersOnLoad()</script><link rel=stylesheet href=/css/code.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/footer.css><link rel=stylesheet href=/css/font-awesome.min.css integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin=anonymous><link rel=icon id=light-scheme-icon href=/favicons/favicon_B_Light.ico type=image/x-icon><link rel=icon id=dark-scheme-icon href=/favicons/favicon_B_Dark.ico type=image/x-icon><script src=/js/favicon.js></script></head><body><div class=container><div class=header><h1>RK and Jetson SDK full work on ArchLinux</h1>Mon, 2024-01-15<br>本文最后修改于 Mon, 2024-07-22<hr></div><div class=middle><div id=TitleWithToc><div id=TitleOfToc>RK and Jetson SDK full work on ArchLinux</div></div><div id=content><h2 id=tldr>tl;dr</h2><p>遇到的几个问题，和解决措施：</p><table><col style=width:6%><col style=width:25%><col style=width:68%><thead><tr class=header><th>Platform</th><th>Problem</th><th>Solution</th></tr></thead><tbody><tr class=odd><td>RK</td><td><code>mknod failed</code></td><td>remount docker volume with <code>nodev,noexec</code></td></tr><tr class=even><td><del>Jetson</del></td><td><del><code>showmount -e</code> oom</del></td><td><del>ulimit docker option add <code>--ulimit nofile=1024:524288</code></del></td></tr><tr class=odd><td>RK Jetson</td><td>RK Maskrom and jetson burn failed</td><td>disable usbcore autosuspend, <code>echo -1 > /sys/module/usbcore/parameters/autosuspend</code></td></tr><tr class=even><td>Jetson</td><td><code>Error: ipv6: address already assigned.</code></td><td>no <code>ping6</code> command, add a ping6 in PATH</td></tr><tr class=odd><td><del>Jetson</del></td><td><del><code>mount.nfs: Connection timed out</code></del></td><td><del>systemctl restart nfs-server</del> 看起来是我错误地添加 sudo 导致的，后面没再复现。</td></tr><tr class=even><td>Jetson</td><td><code>failed to flash</code> (something like this)</td><td>arch ssh does not support <code>dsa</code>, <code>tools/ota_tools/version_upgrade/ota_make_recovery_img_dtb.sh</code> 118 行附近，去除 dsa sshd key 的生成</td></tr><tr class=odd><td>RK</td><td>uboot make menuconfig failed</td><td>add <code>cc -> gcc-7</code> to PATH</td></tr><tr class=even><td>RK</td><td>native <code>cp2102</code> driver does not support 1500000</td><td>Use <a href=https://aur.archlinux.org/packages/cp210x-overclock-dkms>AUR cp210x-overclock-dkms</a></td></tr></tbody></table><ul><li>由于 docker 中 nfs 有问题（包括 service restart nfs），所以目前我没有使用 docker</li></ul><p>其他一些 Ubuntu 和 Arch 兼容性的问题：</p><div class=sourceCode id=cb1><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb1-1><a href=#cb1-1 aria-hidden=true></a><span class=co># Linux_for_Tegra/tools/kernel_flash/l4t_network_flash.func</span></span>
<span id=cb1-2><a href=#cb1-2 aria-hidden=true></a><span class=fu>enable_nfs_for_folder ()</span></span>
<span id=cb1-3><a href=#cb1-3 aria-hidden=true></a><span class=kw>{</span></span>
<span id=cb1-4><a href=#cb1-4 aria-hidden=true></a>    <span class=ex>...</span></span>
<span id=cb1-5><a href=#cb1-5 aria-hidden=true></a>    <span class=co>#chown root.root &quot;${nfs_dir}&quot;</span></span>
<span id=cb1-6><a href=#cb1-6 aria-hidden=true></a>    <span class=fu>chown</span> root:root <span class=st>&quot;</span><span class=va>${nfs_dir}</span><span class=st>&quot;</span></span>
<span id=cb1-7><a href=#cb1-7 aria-hidden=true></a>    <span class=ex>...</span></span>
<span id=cb1-8><a href=#cb1-8 aria-hidden=true></a><span class=kw>}</span></span></code></pre></div><div class=sourceCode id=cb2><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb2-1><a href=#cb2-1 aria-hidden=true></a><span class=co># Linux_for_Tegra/tools/kernel_flash/l4t_network_flash.func</span></span>
<span id=cb2-2><a href=#cb2-2 aria-hidden=true></a><span class=fu>network_prerequisite ()</span></span>
<span id=cb2-3><a href=#cb2-3 aria-hidden=true></a><span class=kw>{</span></span>
<span id=cb2-4><a href=#cb2-4 aria-hidden=true></a>    <span class=ex>...</span></span>
<span id=cb2-5><a href=#cb2-5 aria-hidden=true></a>    <span class=co>#service nfs-kernel-server restart</span></span>
<span id=cb2-6><a href=#cb2-6 aria-hidden=true></a>    <span class=ex>systemctl</span> restart nfs-server</span>
<span id=cb2-7><a href=#cb2-7 aria-hidden=true></a>    <span class=ex>...</span></span>
<span id=cb2-8><a href=#cb2-8 aria-hidden=true></a><span class=kw>}</span></span></code></pre></div><h2 id=introduction>Introduction</h2><p>因为我们用 RK 的板子，然后我在使用 Arch 时遇到一个问题，在板子是 <code>Maskrom</code> 状态的时候，我用 RK 提供的 <code>upgrade_tool</code> 不能烧录，会报段错误，提给 redmine 后，修复了段错误的问题，但是还是不能烧录，这个时候报下面的错误：</p><pre class=log><code>14:40:29        Upgrade Tool v2.26
14:40:29        Current process in /home/ben/Downloads/upgrade_tool_v2.26_for_linux
14:40:29        Using /home/ben/Downloads/upgrade_tool_v2.26_for_linux/config.ini
14:40:29        Command Line: ./upgrade_tool uf /home/ben/nfs/ubuntu_local/benWork/images/RK/RK3588_20230907-1/rockdev/update.img
14:40:29        Current Device Location ID:13
14:41:12        Error:InitializeUsb--&gt;open device failed,err=-1,device=0x11d19f0
14:41:12        Error:upgrade_firmware-&gt;Fail to create comm object!</code></pre><p>反馈给 RK 无果后，此事搁置了。最近又在用 nvidia jetson 的板子，Nvidia 提供了烧录的 <a href=https://catalog.ngc.nvidia.com/orgs/nvidia/containers/jetson-linux-flash-x86>docker</a>(Arch 上 docker 有点问题，<code>showmount -e</code> 会 oom，要做 ulimit 限制 nofile) 又是不能烧录， <code>flash.sh</code> 报的错如下</p><pre class=log><code>...
[   0.2263 ] tegrarcm_v2 --new_session --chip 0x23 0 --uid --download bct_br br_bct_BR.bct --download mb1 mb1_t234_prod_aligned_sigheader.bin.encrypt --download psc_bl1 psc_bl1_t234_prod_aligned_sigheader.bin.encrypt --download bct_mb1 mb1_bct_MB1_sigheader.bct.encrypt
[   0.2275 ] BR_CID: 0x80012344705DE7C8200000000EFD80C0
[   0.2351 ] Sending bct_br
[   0.2351 ] ERROR: might be timeout in USB write.
Error: Return value 3
Command tegrarcm_v2 --new_session --chip 0x23 0 --uid --download bct_br br_bct_BR.bct --download mb1 mb1_t234_prod_aligned_sigheader.bin.encrypt --download psc_bl1 psc_bl1_t234_prod_aligned_sigheader.bin.encrypt --download bct_mb1 mb1_bct_MB1_sigheader.bct.encrypt
Reading board information failed.
Error: failed to generate images
Cleaning up...
Keeping working dir at /l4t/Linux_for_Tegra/temp_initrdflash/bootloader0 and /tmp/tmp.9slBpS2jmL</code></pre><p>嘿，RK 的无果，Nvidia 的可以看看，当然我这个时候没有意识到两者有关联性，最后看到了这条 <a href=https://forums.developer.nvidia.com/t/cannot-flash-jetson-agx-orin-jetpack-5-1-1/253705/15>post</a>，说禁用 usbcore 的 autosuspend。<code>echo -1 > /sys/module/usbcore/parameters/autosuspend</code>，然后真的，重新启动 jetson 的板子后，就能烧录了，太牛了。这个时候突然回想起来，usbcore 的 autosuspend？那 RK 的是不是也可以了，马上一试，果然，Maskrom 也能烧录了。爽啊，从此，我 Arch 的一条腿被接上来呃，原来说残次品是因为，RK 的首选支持是 Windows ，Jetson 的首选支持是 Ubuntu，但是我哪个都没用，就很尴尬。</p><h2 id=work-space-creation>work space creation</h2><h3 id=rk>RK</h3><p>参考 《Rockchip_Developer_Guide_Linux_Docker_Deploy_CN.pdf》</p><div class=sourceCode id=cb5><pre class="sourceCode dockerfile"><code class="sourceCode dockerfile"><span id=cb5-1><a href=#cb5-1 aria-hidden=true></a><span class=kw>FROM</span> ubuntu:22.04</span>
<span id=cb5-2><a href=#cb5-2 aria-hidden=true></a><span class=kw>ENV</span> DEBIAN_FRONTEND=noninteractive</span>
<span id=cb5-3><a href=#cb5-3 aria-hidden=true></a><span class=kw>RUN</span> \</span>
<span id=cb5-4><a href=#cb5-4 aria-hidden=true></a>sed -i <span class=st>&#39;s/archive.ubuntu.com/mirrors.ustc.edu.cn/&#39;</span> /etc/apt/sources.list \</span>
<span id=cb5-5><a href=#cb5-5 aria-hidden=true></a>&amp;&amp; apt-get update -y &amp;&amp; apt-get upgrade -y \</span>
<span id=cb5-6><a href=#cb5-6 aria-hidden=true></a>&amp;&amp; apt-get install -y curl repo \</span>
<span id=cb5-7><a href=#cb5-7 aria-hidden=true></a>&amp;&amp; apt-get install -y bc binfmt-support bison bsdmainutils build-essential bzip2 chrpath cmake cpio cpp-aarch64-linux-gnu \</span>
<span id=cb5-8><a href=#cb5-8 aria-hidden=true></a>debianutils device-tree-compiler diffstat expat expect fakeroot fdisk file flex g++ gawk gcc gcc-multilib git git-core \</span>
<span id=cb5-9><a href=#cb5-9 aria-hidden=true></a>g++-multilib gpgv2 iputils-ping libegl1-mesa libelf-dev libgmp-dev libgucharmap-2-90-dev liblz4-tool libmpc-dev \</span>
<span id=cb5-10><a href=#cb5-10 aria-hidden=true></a>libsdl1.2-dev libssl-dev live-build make ncurses-dev net-tools patchelf python2 python3 python-is-python3 python3-git \</span>
<span id=cb5-11><a href=#cb5-11 aria-hidden=true></a>python3-jinja2 python3-pexpect python3-pip qemu-user-static rsync socat ssh strace sudo texinfo time tree unzip vim \</span>
<span id=cb5-12><a href=#cb5-12 aria-hidden=true></a>wget xterm xz-utils zstd \</span>
<span id=cb5-13><a href=#cb5-13 aria-hidden=true></a>&amp;&amp; useradd -c <span class=st>&#39;ben user&#39;</span> -m -d /home/kenxes -s /bin/bash ben &amp;&amp; sed -i -e <span class=st>&#39;/\%sudo/ c \%sudo ALL=(ALL) NOPASSWD: ALL&#39;</span> /etc/sudoers &amp;&amp; usermod -a -G sudo ben \</span>
<span id=cb5-14><a href=#cb5-14 aria-hidden=true></a>&amp;&amp; mkdir /home/ben/ \</span>
<span id=cb5-15><a href=#cb5-15 aria-hidden=true></a>&amp;&amp; su ben -c <span class=st>&#39;pip3 install pyelftools -i http://pypi.mirrors.ustc.edu.cn/simple/ --trusted-host pypi.mirrors.ustc.edu.cn&#39;</span> \</span>
<span id=cb5-16><a href=#cb5-16 aria-hidden=true></a>&amp;&amp; echo <span class=st>&quot;docker image build complete&quot;</span> \</span>
<span id=cb5-17><a href=#cb5-17 aria-hidden=true></a>&amp;&amp; echo <span class=st>&quot;set timezone&quot;</span> \</span>
<span id=cb5-18><a href=#cb5-18 aria-hidden=true></a>&amp;&amp; ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \</span>
<span id=cb5-19><a href=#cb5-19 aria-hidden=true></a>&amp;&amp; echo Asia/Shanghai &gt; /etc/timezone \</span>
<span id=cb5-20><a href=#cb5-20 aria-hidden=true></a>&amp;&amp; echo <span class=st>&quot;extra dependencies for buildroot&quot;</span> \</span>
<span id=cb5-21><a href=#cb5-21 aria-hidden=true></a>&amp;&amp; git clone https://salsa.debian.org/live-team/live-build.git --depth 1 -b debian/1%20230131 \</span>
<span id=cb5-22><a href=#cb5-22 aria-hidden=true></a>&amp;&amp; rm -rf live-build/manpages/po/* \</span>
<span id=cb5-23><a href=#cb5-23 aria-hidden=true></a>&amp;&amp; make install -j8 -C live-build \</span>
<span id=cb5-24><a href=#cb5-24 aria-hidden=true></a>&amp;&amp; rm -rf live-build \</span>
<span id=cb5-25><a href=#cb5-25 aria-hidden=true></a>&amp;&amp; apt-get -y autoclean &amp;&amp; apt-get -y autoremove &amp;&amp; rm -rf /var/lib/apt/lists/*</span></code></pre></div><h4 id=use-the-container>use the container</h4><div class=sourceCode id=cb6><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id=cb6-1><a href=#cb6-1 aria-hidden=true></a><span class=fu>make_docker_rockchip_run()</span><span class=kw>{</span></span>
<span id=cb6-2><a href=#cb6-2 aria-hidden=true></a>    <span class=kw>if [</span> <span class=st>&quot;</span><span class=ot>$1</span><span class=st>&quot;</span> <span class=ot>=</span> <span class=st>&quot;RK3588&quot;</span><span class=kw> ]</span> <span class=kw>|| [</span> <span class=st>&quot;</span><span class=ot>$1</span><span class=st>&quot;</span> <span class=ot>=</span> <span class=st>&quot;RK3399&quot;</span><span class=kw> ]</span>;<span class=kw>then</span></span>
<span id=cb6-3><a href=#cb6-3 aria-hidden=true></a>        <span class=ot>platform=</span><span class=st>&quot;</span><span class=ot>$1</span><span class=st>&quot;</span></span>
<span id=cb6-4><a href=#cb6-4 aria-hidden=true></a>    <span class=kw>else</span></span>
<span id=cb6-5><a href=#cb6-5 aria-hidden=true></a>        <span class=ot>platform=</span><span class=st>&quot;RK3588&quot;</span></span>
<span id=cb6-6><a href=#cb6-6 aria-hidden=true></a>        <span class=kw>echo</span> <span class=st>&quot;use default platform </span><span class=ot>$platform</span><span class=st>&quot;</span> <span class=kw>&gt;&amp;2</span></span>
<span id=cb6-7><a href=#cb6-7 aria-hidden=true></a>    <span class=kw>fi</span></span>
<span id=cb6-8><a href=#cb6-8 aria-hidden=true></a>    <span class=ot>proxy_server=</span><span class=st>&quot;172.17.0.1:8119&quot;</span></span>
<span id=cb6-9><a href=#cb6-9 aria-hidden=true></a>    <span class=ot>env_all=(</span><span class=st>&quot;USER=ben&quot;</span> <span class=st>&quot;http_proxy=http://</span><span class=ot>$proxy_server</span><span class=st>&quot;</span> <span class=st>&quot;https_proxy=http://</span><span class=ot>$proxy_server</span><span class=st>&quot;</span><span class=ot>)</span></span>
<span id=cb6-10><a href=#cb6-10 aria-hidden=true></a>    docker run --rm --privileged -it -u ben <span class=kw>\</span></span>
<span id=cb6-11><a href=#cb6-11 aria-hidden=true></a>            --ulimit <span class=ot>nofile=</span>1024:524288 <span class=kw>\</span></span>
<span id=cb6-12><a href=#cb6-12 aria-hidden=true></a>            -v <span class=st>&quot;</span><span class=ot>$PWD</span><span class=st>&quot;</span>:/<span class=st>&quot;</span><span class=ot>$platform</span><span class=st>&quot;</span>/ <span class=kw>\</span></span>
<span id=cb6-13><a href=#cb6-13 aria-hidden=true></a>            rockchip_build <span class=kw>\</span></span>
<span id=cb6-14><a href=#cb6-14 aria-hidden=true></a>            <span class=kw>env</span> <span class=st>&quot;</span><span class=ot>${env_all[@]}</span><span class=st>&quot;</span> /bin/bash -c <span class=st>&quot;cd </span><span class=ot>$platform</span><span class=st>; \</span></span>
<span id=cb6-15><a href=#cb6-15 aria-hidden=true></a><span class=st>                                              bash ./remount.sh; \</span></span>
<span id=cb6-16><a href=#cb6-16 aria-hidden=true></a><span class=st>                                              exec /bin/bash&quot;</span></span>
<span id=cb6-17><a href=#cb6-17 aria-hidden=true></a><span class=kw>}</span></span></code></pre></div><div class=sourceCode id=cb7><pre class="sourceCode bash"><code class="sourceCode bash"><span id=cb7-1><a href=#cb7-1 aria-hidden=true></a><span class=co>#!/bin/bash</span></span>
<span id=cb7-2><a href=#cb7-2 aria-hidden=true></a><span class=co># remount.sh</span></span>
<span id=cb7-3><a href=#cb7-3 aria-hidden=true></a><span class=bu>read</span> -r <span class=va>dev</span> <span class=va>mount_point</span> <span class=va>mount_options</span> <span class=op>&lt;</span> <span class=op>&lt;(</span><span class=fu>mount</span> -l <span class=kw>|</span> <span class=fu>grep</span> <span class=st>&quot;</span><span class=va>$PWD</span><span class=st>&quot;</span> <span class=kw>|</span> <span class=fu>sed</span> -n <span class=st>&#39;s/\(.*\) on \(.*\) type .* (\(.*\))/\1 \2 \3/p&#39;</span> <span class=op>)</span></span>
<span id=cb7-4><a href=#cb7-4 aria-hidden=true></a><span class=va>mount_options=</span><span class=st>&quot;</span><span class=va>${mount_options/</span>nodev,<span class=va>/}</span><span class=st>&quot;</span></span>
<span id=cb7-5><a href=#cb7-5 aria-hidden=true></a><span class=va>mount_options=</span><span class=st>&quot;</span><span class=va>${mount_options/</span>noexec,<span class=va>/}</span><span class=st>&quot;</span></span>
<span id=cb7-6><a href=#cb7-6 aria-hidden=true></a><span class=va>mount_options=</span><span class=st>&quot;remount,&quot;&quot;</span><span class=va>$mount_options</span><span class=st>&quot;</span></span>
<span id=cb7-7><a href=#cb7-7 aria-hidden=true></a></span>
<span id=cb7-8><a href=#cb7-8 aria-hidden=true></a><span class=fu>mount</span> -l <span class=kw>|</span> <span class=fu>grep</span> <span class=st>&quot;</span><span class=va>$PWD</span><span class=st>&quot;</span></span>
<span id=cb7-9><a href=#cb7-9 aria-hidden=true></a><span class=bu>echo</span> <span class=st>&quot;mount </span><span class=va>$dev</span><span class=st> </span><span class=va>$mount_point</span><span class=st>&quot;</span> -o <span class=st>&quot;</span><span class=va>$mount_options</span><span class=st>&quot;</span></span>
<span id=cb7-10><a href=#cb7-10 aria-hidden=true></a></span>
<span id=cb7-11><a href=#cb7-11 aria-hidden=true></a><span class=bu>echo</span> -n <span class=st>&quot;do it? &quot;</span></span>
<span id=cb7-12><a href=#cb7-12 aria-hidden=true></a><span class=bu>read</span> -r <span class=va>doit</span></span>
<span id=cb7-13><a href=#cb7-13 aria-hidden=true></a></span>
<span id=cb7-14><a href=#cb7-14 aria-hidden=true></a><span class=kw>if</span><span class=bu> [</span> <span class=st>&quot;</span><span class=va>$doit</span><span class=st>&quot;</span> <span class=ot>=</span> <span class=st>&quot;y&quot;</span><span class=bu> ]</span>;<span class=kw>then</span></span>
<span id=cb7-15><a href=#cb7-15 aria-hidden=true></a>    <span class=fu>sudo</span> mount <span class=st>&quot;</span><span class=va>$dev</span><span class=st>&quot;</span> <span class=st>&quot;</span><span class=va>$mount_point</span><span class=st>&quot;</span> -o <span class=st>&quot;</span><span class=va>$mount_options</span><span class=st>&quot;</span></span>
<span id=cb7-16><a href=#cb7-16 aria-hidden=true></a><span class=kw>fi</span></span>
<span id=cb7-17><a href=#cb7-17 aria-hidden=true></a><span class=fu>mount</span> -l <span class=kw>|</span> <span class=fu>grep</span> <span class=st>&quot;</span><span class=va>$PWD</span><span class=st>&quot;</span></span></code></pre></div><h3 id=jetson>Jetson</h3><p>Arch 中没有 <code>ping6</code> 这个命令，所以需要做一个，记得添加到 PATH 里</p><div class=sourceCode id=cb8><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb8-1><a href=#cb8-1 aria-hidden=true></a><span class=co># /usr/local/bin/ping6</span></span>
<span id=cb8-2><a href=#cb8-2 aria-hidden=true></a><span class=co>#!/bin/sh</span></span>
<span id=cb8-3><a href=#cb8-3 aria-hidden=true></a><span class=fu>ping</span> -6 <span class=st>&quot;</span><span class=va>$@</span><span class=st>&quot;</span></span></code></pre></div><p>有一个 bug: <code>chown root.root "${nfs_dir}"</code></p><div class=sourceCode id=cb9><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb9-1><a href=#cb9-1 aria-hidden=true></a><span class=co># Linux_for_Tegra/tools/kernel_flash/l4t_network_flash.func</span></span>
<span id=cb9-2><a href=#cb9-2 aria-hidden=true></a><span class=fu>enable_nfs_for_folder ()</span></span>
<span id=cb9-3><a href=#cb9-3 aria-hidden=true></a><span class=kw>{</span></span>
<span id=cb9-4><a href=#cb9-4 aria-hidden=true></a>    <span class=ex>...</span></span>
<span id=cb9-5><a href=#cb9-5 aria-hidden=true></a>    <span class=co>#chown root.root &quot;${nfs_dir}&quot;</span></span>
<span id=cb9-6><a href=#cb9-6 aria-hidden=true></a>    <span class=fu>chown</span> root:root <span class=st>&quot;</span><span class=va>${nfs_dir}</span><span class=st>&quot;</span></span>
<span id=cb9-7><a href=#cb9-7 aria-hidden=true></a>    <span class=ex>...</span></span>
<span id=cb9-8><a href=#cb9-8 aria-hidden=true></a><span class=kw>}</span></span></code></pre></div><ul><li><code>nfs-kernel-server</code> -> <code>nfs-server</code></li><li><code>service</code> -> <code>systemctl</code></li></ul><div class=sourceCode id=cb10><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb10-1><a href=#cb10-1 aria-hidden=true></a><span class=co># Linux_for_Tegra/tools/kernel_flash/l4t_network_flash.func</span></span>
<span id=cb10-2><a href=#cb10-2 aria-hidden=true></a><span class=fu>network_prerequisite ()</span></span>
<span id=cb10-3><a href=#cb10-3 aria-hidden=true></a><span class=kw>{</span></span>
<span id=cb10-4><a href=#cb10-4 aria-hidden=true></a>    <span class=co>#service nfs-kernel-server restart</span></span>
<span id=cb10-5><a href=#cb10-5 aria-hidden=true></a>    <span class=ex>systemctl</span> restart nfs-server</span>
<span id=cb10-6><a href=#cb10-6 aria-hidden=true></a><span class=kw>}</span></span></code></pre></div><p>nfs 可能还有一个问题，会报超时，需要重新 export 一下，可以通过 <code>exportfs -s</code> 查看两个 ipv6 的 share，然后重新 export 一下，我前几次遇到了，后面再次烧录就没遇到了:</p><div class=sourceCode id=cb11><pre class="sourceCode sh"><code class="sourceCode bash"><span id=cb11-1><a href=#cb11-1 aria-hidden=true></a><span class=fu>sudo</span> exportfs -o rw,nohide,insecure,no_subtree_check,async,no_root_squash <span class=st>&#39;[fc00:1:1::/48]:/r35.3.1/Linux_for_Tegra/rootfs&#39;</span></span>
<span id=cb11-2><a href=#cb11-2 aria-hidden=true></a><span class=fu>sudo</span> exportfs -o rw,nohide,insecure,no_subtree_check,async,no_root_squash <span class=st>&#39;[fc00:1:1::/48]:/r35.3.1/Linux_for_Tegra/tools/kernel_flash&#39;</span></span></code></pre></div></div><div id=Rsidebar><div id=Avatar><img alt=avatar src=/avatar.jpg></div><ul><li><a href=/about>About Me</a></li><li><a href=/donate>Donate Me</a></li><li><a href=/>Ben's Blog</a></li></ul>除非注明，本博客所有文章皆为原创。<br>本作品采用<a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。</div></div><div class=footer><div id=tags><a href=https://bensyz.github.io/blog/tags><i class="fas fa-tags"></i></a>
Keywords:<ul><li><a href=https://bensyz.github.io/blog/tags/arch>arch</a></li><li><a href=https://bensyz.github.io/blog/tags/jetson>jetson</a></li><li><a href=https://bensyz.github.io/blog/tags/rk>rk</a></li><li><a href=https://bensyz.github.io/blog/tags/docker>docker</a></li><li><a href=https://bensyz.github.io/blog/tags/linux>linux</a></li></ul></div><footer><hr><a href=/>Ben's Blog</a><br>本作品采用<a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/>知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。<br><a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33028102001039"><img alt=public_safety_record src=/icons/public_safety_icon.png>浙公网安备 33028102001039号</a>
<a href=https://beian.miit.gov.cn/ target=_blank>浙ICP备2021032097号-1</a></footer></div></div></body></html>