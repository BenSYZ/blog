<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>NVIDIA on Ben's Blog</title><link>https://bensyz.github.io/blog/tags/NVIDIA/</link><description>Recent content in NVIDIA on Ben's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 28 Apr 2025 11:50:29 +0800</lastBuildDate><atom:link href="https://bensyz.github.io/blog/tags/NVIDIA/index.xml" rel="self" type="application/rss+xml"/><item><title>install NVIDIA supported docker</title><link>https://bensyz.github.io/blog/blogs/install_nvidia_docker/</link><pubDate>Mon, 28 Apr 2025 11:50:29 +0800</pubDate><guid>https://bensyz.github.io/blog/blogs/install_nvidia_docker/</guid><description>&lt;h2 id="docker">docker&lt;/h2>
&lt;p>&lt;a href="https://docs.docker.com/engine/install/ubuntu/">official doc&lt;/a>&lt;/p>
&lt;h3 id="装">装&lt;/h3>
&lt;div class="sourceCode" id="cb1">&lt;pre class="sourceCode sh">&lt;code class="sourceCode bash">&lt;span id="cb1-1">&lt;a href="#cb1-1" aria-hidden="true">&lt;/a>&lt;span class="co"># 拷自 official doc&lt;/span>&lt;/span>
&lt;span id="cb1-2">&lt;a href="#cb1-2" aria-hidden="true">&lt;/a>&lt;span class="co"># Add Docker&amp;#39;s official GPG key:&lt;/span>&lt;/span>
&lt;span id="cb1-3">&lt;a href="#cb1-3" aria-hidden="true">&lt;/a>&lt;span class="fu">sudo&lt;/span> apt-get update&lt;/span>
&lt;span id="cb1-4">&lt;a href="#cb1-4" aria-hidden="true">&lt;/a>&lt;span class="fu">sudo&lt;/span> apt-get install ca-certificates curl&lt;/span>
&lt;span id="cb1-5">&lt;a href="#cb1-5" aria-hidden="true">&lt;/a>&lt;span class="fu">sudo&lt;/span> install -m 0755 -d /etc/apt/keyrings&lt;/span>
&lt;span id="cb1-6">&lt;a href="#cb1-6" aria-hidden="true">&lt;/a>&lt;span class="fu">sudo&lt;/span> curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc&lt;/span>
&lt;span id="cb1-7">&lt;a href="#cb1-7" aria-hidden="true">&lt;/a>&lt;span class="fu">sudo&lt;/span> chmod a+r /etc/apt/keyrings/docker.asc&lt;/span>
&lt;span id="cb1-8">&lt;a href="#cb1-8" aria-hidden="true">&lt;/a>&lt;/span>
&lt;span id="cb1-9">&lt;a href="#cb1-9" aria-hidden="true">&lt;/a>&lt;span class="co"># Add the repository to Apt sources:&lt;/span>&lt;/span>
&lt;span id="cb1-10">&lt;a href="#cb1-10" aria-hidden="true">&lt;/a>&lt;span class="bu">echo&lt;/span> &lt;span class="kw">\&lt;/span>&lt;/span>
&lt;span id="cb1-11">&lt;a href="#cb1-11" aria-hidden="true">&lt;/a> &lt;span class="st">&amp;quot;deb [arch=&lt;/span>&lt;span class="va">$(&lt;/span>&lt;span class="ex">dpkg&lt;/span> --print-architecture&lt;span class="va">)&lt;/span>&lt;span class="st"> signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \&lt;/span>&lt;/span>
&lt;span id="cb1-12">&lt;a href="#cb1-12" aria-hidden="true">&lt;/a>&lt;span class="st"> &lt;/span>&lt;span class="va">$(&lt;/span>&lt;span class="bu">.&lt;/span> &lt;span class="ex">/etc/os-release&lt;/span> &lt;span class="kw">&amp;amp;&amp;amp;&lt;/span> &lt;span class="bu">echo&lt;/span> &lt;span class="st">&amp;quot;&lt;/span>&lt;span class="va">${UBUNTU_CODENAME:-$VERSION_CODENAME}&lt;/span>&lt;span class="st">&amp;quot;&lt;/span>&lt;span class="va">)&lt;/span>&lt;span class="st"> stable&amp;quot;&lt;/span> &lt;span class="kw">|&lt;/span> &lt;span class="kw">\&lt;/span>&lt;/span>
&lt;span id="cb1-13">&lt;a href="#cb1-13" aria-hidden="true">&lt;/a> &lt;span class="fu">sudo&lt;/span> tee /etc/apt/sources.list.d/docker.list &lt;span class="op">&amp;gt;&lt;/span> /dev/null&lt;/span>
&lt;span id="cb1-14">&lt;a href="#cb1-14" aria-hidden="true">&lt;/a>&lt;span class="fu">sudo&lt;/span> apt-get update&lt;/span>
&lt;span id="cb1-15">&lt;a href="#cb1-15" aria-hidden="true">&lt;/a>&lt;/span>
&lt;span id="cb1-16">&lt;a href="#cb1-16" aria-hidden="true">&lt;/a>&lt;span class="fu">sudo&lt;/span> apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="配">配&lt;/h3>
&lt;h4 id="user-add-to-docker-group">user add to docker group&lt;/h4>
&lt;div class="sourceCode" id="cb2">&lt;pre class="sourceCode sh">&lt;code class="sourceCode bash">&lt;span id="cb2-1">&lt;a href="#cb2-1" aria-hidden="true">&lt;/a>&lt;span class="ex">useradd&lt;/span> -a -G docker &lt;span class="op">&amp;lt;&lt;/span>username&lt;span class="op">&amp;gt;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;p>重登&lt;/p>
&lt;h4 id="add-proxy">add proxy&lt;/h4>
&lt;div class="sourceCode" id="cb3">&lt;pre class="sourceCode sh">&lt;code class="sourceCode bash">&lt;span id="cb3-1">&lt;a href="#cb3-1" aria-hidden="true">&lt;/a>&lt;span class="ex">systemctl&lt;/span> edit docker&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;pre class="conf">&lt;code>[Service]
Environment=&amp;quot;HTTP_PROXY=http://localhost:8118&amp;quot;
Environment=&amp;quot;HTTPS_PROXY=http://localhost:8118&amp;quot;&lt;/code>&lt;/pre>
&lt;h2 id="nvidia">NVIDIA&lt;/h2>
&lt;p>分两部分&lt;/p>
&lt;ul>
&lt;li>driver：host 机上要能操作 GPU (&lt;a href="https://docs.nvidia.com/datacenter/tesla/driver-installation-guide/index.html">official doc&lt;/a>)&lt;/li>
&lt;li>container：可以将 GPU 传递到 docker 内 (&lt;a href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html">official doc&lt;/a>)&lt;/li>
&lt;/ul>
&lt;p>可以从 container 的 &lt;a href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html">official doc&lt;/a> 入手。&lt;/p>
&lt;h3 id="driver">driver&lt;/h3>
&lt;p>container 第一节给了一个链接跳转到 &lt;a href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/">cuda-installation doc&lt;/a>，我们不需要在 host 机上装 cuda，所以点右边 &lt;a href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/#driver-installation">4. Driver Installation&lt;/a>，直接给了个 &lt;a href="https://docs.nvidia.com/datacenter/tesla/driver-installation-guide/index.html">tesla 的 driver installation doc&lt;/a>&lt;/p>
&lt;h4 id="先下-keyring">先下 keyring&lt;/h4>
&lt;div class="sourceCode" id="cb5">&lt;pre class="sourceCode sh">&lt;code class="sourceCode bash">&lt;span id="cb5-1">&lt;a href="#cb5-1" aria-hidden="true">&lt;/a>&lt;span class="co"># ubuntu2204/x86_64&lt;/span>&lt;/span>
&lt;span id="cb5-2">&lt;a href="#cb5-2" aria-hidden="true">&lt;/a>&lt;span class="fu">wget&lt;/span> https://developer.download.nvidia.com/compute/cuda/repos/&lt;span class="op">&amp;lt;&lt;/span>distro&lt;span class="op">&amp;gt;&lt;/span>/&lt;span class="op">&amp;lt;&lt;/span>arch&lt;span class="op">&amp;gt;&lt;/span>/cuda-keyring_1.1-1_all.deb&lt;/span>
&lt;span id="cb5-3">&lt;a href="#cb5-3" aria-hidden="true">&lt;/a>&lt;span class="fu">sudo&lt;/span> dpkg -i cuda-keyring_1.1-1_all.deb&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;h4 id="下">下&lt;/h4>
&lt;p>选择开源还是闭源驱动可以看 &lt;a href="https://docs.nvidia.com/datacenter/tesla/driver-installation-guide/index.html#kernel-modules">5. Kernel Modules&lt;/a>&lt;/p>
&lt;p>新的是 open source 的 driver 的&lt;/p>
&lt;div class="sourceCode" id="cb6">&lt;pre class="sourceCode sh">&lt;code class="sourceCode bash">&lt;span id="cb6-1">&lt;a href="#cb6-1" aria-hidden="true">&lt;/a>&lt;span class="fu">sudo&lt;/span> apt-get update&lt;/span>
&lt;span id="cb6-2">&lt;a href="#cb6-2" aria-hidden="true">&lt;/a>&lt;span class="ex">apt&lt;/span> install nvidia-open&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;h4 id="验">验&lt;/h4>
&lt;div class="sourceCode" id="cb7">&lt;pre class="sourceCode sh">&lt;code class="sourceCode bash">&lt;span id="cb7-1">&lt;a href="#cb7-1" aria-hidden="true">&lt;/a>&lt;span class="ex">nvidia-smi&lt;/span>&lt;/span>
&lt;span id="cb7-2">&lt;a href="#cb7-2" aria-hidden="true">&lt;/a>&lt;span class="ex">reboot&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="nvidia-container-toolkit">NVIDIA Container Toolkit&lt;/h3>
&lt;p>&lt;a href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html">official doc&lt;/a>&lt;/p>
&lt;h4 id="装-1">装&lt;/h4>
&lt;div class="sourceCode" id="cb8">&lt;pre class="sourceCode sh">&lt;code class="sourceCode bash">&lt;span id="cb8-1">&lt;a href="#cb8-1" aria-hidden="true">&lt;/a>&lt;span class="co"># 拷自 official doc&lt;/span>&lt;/span>
&lt;span id="cb8-2">&lt;a href="#cb8-2" aria-hidden="true">&lt;/a>&lt;span class="ex">curl&lt;/span> -fsSL https://nvidia.github.io/libnvidia-container/gpgkey &lt;span class="kw">|&lt;/span> &lt;span class="fu">sudo&lt;/span> gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg &lt;span class="kw">\&lt;/span>&lt;/span>
&lt;span id="cb8-3">&lt;a href="#cb8-3" aria-hidden="true">&lt;/a> &lt;span class="kw">&amp;amp;&amp;amp;&lt;/span> &lt;span class="ex">curl&lt;/span> -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list &lt;span class="kw">|&lt;/span> &lt;span class="kw">\&lt;/span>&lt;/span>
&lt;span id="cb8-4">&lt;a href="#cb8-4" aria-hidden="true">&lt;/a> &lt;span class="fu">sed&lt;/span> &lt;span class="st">&amp;#39;s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g&amp;#39;&lt;/span> &lt;span class="kw">|&lt;/span> &lt;span class="kw">\&lt;/span>&lt;/span>
&lt;span id="cb8-5">&lt;a href="#cb8-5" aria-hidden="true">&lt;/a> &lt;span class="fu">sudo&lt;/span> tee /etc/apt/sources.list.d/nvidia-container-toolkit.list&lt;/span>
&lt;span id="cb8-6">&lt;a href="#cb8-6" aria-hidden="true">&lt;/a>&lt;span class="fu">sed&lt;/span> -i -e &lt;span class="st">&amp;#39;/experimental/ s/^#//g&amp;#39;&lt;/span> /etc/apt/sources.list.d/nvidia-container-toolkit.list&lt;/span>
&lt;span id="cb8-7">&lt;a href="#cb8-7" aria-hidden="true">&lt;/a>&lt;span class="fu">sudo&lt;/span> apt-get update&lt;/span>
&lt;span id="cb8-8">&lt;a href="#cb8-8" aria-hidden="true">&lt;/a>&lt;span class="fu">sudo&lt;/span> apt-get install -y nvidia-container-toolkit&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="配-1">配&lt;/h3>
&lt;h4 id="nvidia-container-runtime">nvidia-container-runtime&lt;/h4>
&lt;div class="sourceCode" id="cb9">&lt;pre class="sourceCode sh">&lt;code class="sourceCode bash">&lt;span id="cb9-1">&lt;a href="#cb9-1" aria-hidden="true">&lt;/a>&lt;span class="co"># 拷自 official doc&lt;/span>&lt;/span>
&lt;span id="cb9-2">&lt;a href="#cb9-2" aria-hidden="true">&lt;/a>&lt;span class="fu">sudo&lt;/span> nvidia-ctk runtime configure --runtime=docker&lt;/span>
&lt;span id="cb9-3">&lt;a href="#cb9-3" aria-hidden="true">&lt;/a>&lt;span class="co"># /etc/docker/daemon.json&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;h4 id="btrfs">btrfs&lt;/h4>
&lt;p>&lt;code>/etc/docker/daemon.json&lt;/code>&lt;/p>
&lt;div class="sourceCode" id="cb10">&lt;pre class="sourceCode json">&lt;code class="sourceCode json">&lt;span id="cb10-1">&lt;a href="#cb10-1" aria-hidden="true">&lt;/a>&lt;span class="fu">{&lt;/span>&lt;/span>
&lt;span id="cb10-2">&lt;a href="#cb10-2" aria-hidden="true">&lt;/a> &lt;span class="dt">&amp;quot;storage-driver&amp;quot;&lt;/span>&lt;span class="fu">:&lt;/span> &lt;span class="st">&amp;quot;btrfs&amp;quot;&lt;/span>&lt;/span>
&lt;span id="cb10-3">&lt;a href="#cb10-3" aria-hidden="true">&lt;/a>&lt;span class="fu">}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;h4 id="results">results&lt;/h4>
&lt;p>&lt;code>/etc/docker/daemon.json&lt;/code>&lt;/p>
&lt;div class="sourceCode" id="cb11">&lt;pre class="sourceCode json">&lt;code class="sourceCode json">&lt;span id="cb11-1">&lt;a href="#cb11-1" aria-hidden="true">&lt;/a>&lt;span class="fu">{&lt;/span>&lt;/span>
&lt;span id="cb11-2">&lt;a href="#cb11-2" aria-hidden="true">&lt;/a> &lt;span class="dt">&amp;quot;storage-driver&amp;quot;&lt;/span>&lt;span class="fu">:&lt;/span> &lt;span class="st">&amp;quot;btrfs&amp;quot;&lt;/span>&lt;span class="fu">,&lt;/span>&lt;/span>
&lt;span id="cb11-3">&lt;a href="#cb11-3" aria-hidden="true">&lt;/a> &lt;span class="dt">&amp;quot;runtimes&amp;quot;&lt;/span>&lt;span class="fu">:&lt;/span> &lt;span class="fu">{&lt;/span>&lt;/span>
&lt;span id="cb11-4">&lt;a href="#cb11-4" aria-hidden="true">&lt;/a> &lt;span class="dt">&amp;quot;nvidia&amp;quot;&lt;/span>&lt;span class="fu">:&lt;/span> &lt;span class="fu">{&lt;/span>&lt;/span>
&lt;span id="cb11-5">&lt;a href="#cb11-5" aria-hidden="true">&lt;/a> &lt;span class="dt">&amp;quot;args&amp;quot;&lt;/span>&lt;span class="fu">:&lt;/span> &lt;span class="ot">[]&lt;/span>&lt;span class="fu">,&lt;/span>&lt;/span>
&lt;span id="cb11-6">&lt;a href="#cb11-6" aria-hidden="true">&lt;/a> &lt;span class="dt">&amp;quot;path&amp;quot;&lt;/span>&lt;span class="fu">:&lt;/span> &lt;span class="st">&amp;quot;nvidia-container-runtime&amp;quot;&lt;/span>&lt;/span>
&lt;span id="cb11-7">&lt;a href="#cb11-7" aria-hidden="true">&lt;/a> &lt;span class="fu">}&lt;/span>&lt;/span>
&lt;span id="cb11-8">&lt;a href="#cb11-8" aria-hidden="true">&lt;/a> &lt;span class="fu">}&lt;/span>&lt;/span>
&lt;span id="cb11-9">&lt;a href="#cb11-9" aria-hidden="true">&lt;/a>&lt;span class="fu">}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="测">测&lt;/h3>
&lt;div class="sourceCode" id="cb12">&lt;pre class="sourceCode sh">&lt;code class="sourceCode bash">&lt;span id="cb12-1">&lt;a href="#cb12-1" aria-hidden="true">&lt;/a>&lt;span class="co"># 拷自 official doc&lt;/span>&lt;/span>
&lt;span id="cb12-2">&lt;a href="#cb12-2" aria-hidden="true">&lt;/a>&lt;span class="ex">docker&lt;/span> run --rm --runtime=nvidia --gpus all ubuntu nvidia-smi&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;p>&lt;code>--runtime=nvidia&lt;/code> 通过这个将显卡传递到 docker 里&lt;/p></description></item><item><title>migrate from ubuntu16.04 to ubuntu20.04</title><link>https://bensyz.github.io/blog/blogs/migrate_from_ubuntu16.04_to_20.04_with_nvidia_docker/</link><pubDate>Thu, 13 Apr 2023 11:13:20 +0800</pubDate><guid>https://bensyz.github.io/blog/blogs/migrate_from_ubuntu16.04_to_20.04_with_nvidia_docker/</guid><description>&lt;p>公司服务器需要升级系统&lt;/p>
&lt;ol type="1">
&lt;li>系统升级&lt;/li>
&lt;li>docker 迁移&lt;/li>
&lt;/ol>
&lt;h2 id="系统升级">系统升级&lt;/h2>
&lt;ol type="1">
&lt;li>download and extra to new root&lt;/li>
&lt;/ol>
&lt;div class="sourceCode" id="cb1">&lt;pre class="sourceCode sh">&lt;code class="sourceCode bash">&lt;span id="cb1-1">&lt;a href="#cb1-1" aria-hidden="true">&lt;/a>&lt;span class="ex">curl&lt;/span> https://cdimage.ubuntu.com/ubuntu-base/releases/focal/release/ubuntu-base-20.04.5-base-amd64.tar.gz &lt;span class="kw">|&lt;/span> &lt;span class="fu">sudo&lt;/span> tar -xzvf - -C /mnt&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;ol start="2" type="1">
&lt;li>update and install grub and other needs&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>&lt;code>grub-efi-amd64&lt;/code> # 可能直接 grub 就好，不知道这种基础组建要怎么一下安装&lt;/li>
&lt;li>&lt;code>ubuntu-minimal&lt;/code>&lt;/li>
&lt;li>&lt;code>linux-image-generic&lt;/code>&lt;/li>
&lt;/ul>
&lt;ol start="3" type="1">
&lt;li>然后参考 archlinux wiki installation guide 做些必要的动作，不要忘了 &lt;code>systemd-networkd&lt;/code> 和 &lt;code>sshd&lt;/code>&lt;/li>
&lt;/ol>
&lt;p>特别关注 grub&lt;/p>
&lt;ul>
&lt;li>&lt;code>grub-install&lt;/code>&lt;/li>
&lt;li>&lt;code>grub-config&lt;/code>&lt;/li>
&lt;li>&lt;code>efibootmgr&lt;/code> check 一下&lt;/li>
&lt;/ul>
&lt;h2 id="docker-迁移">docker 迁移&lt;/h2>
&lt;h3 id="rsync">1. &lt;code>rsync&lt;/code>&lt;/h3>
&lt;div class="sourceCode" id="cb2">&lt;pre class="sourceCode sh">&lt;code class="sourceCode bash">&lt;span id="cb2-1">&lt;a href="#cb2-1" aria-hidden="true">&lt;/a>&lt;span class="co"># https://blog.lilydjwg.me/2013/12/29/rsync-btrfs-dm-crypt-full-backup.42219.html&lt;/span>&lt;/span>
&lt;span id="cb2-2">&lt;a href="#cb2-2" aria-hidden="true">&lt;/a>&lt;span class="fu">rsync&lt;/span> --archive --one-file-system --inplace --hard-links &lt;span class="kw">\&lt;/span>&lt;/span>
&lt;span id="cb2-3">&lt;a href="#cb2-3" aria-hidden="true">&lt;/a> &lt;span class="ex">--human-readable&lt;/span> --numeric-ids --delete --delete-excluded &lt;span class="kw">\&lt;/span>&lt;/span>
&lt;span id="cb2-4">&lt;a href="#cb2-4" aria-hidden="true">&lt;/a> &lt;span class="ex">--acls&lt;/span> --xattrs --sparse &lt;span class="kw">\&lt;/span>&lt;/span>
&lt;span id="cb2-5">&lt;a href="#cb2-5" aria-hidden="true">&lt;/a> &lt;span class="ex">--itemize-changes&lt;/span> --verbose --progress &lt;span class="kw">\&lt;/span>&lt;/span>
&lt;span id="cb2-6">&lt;a href="#cb2-6" aria-hidden="true">&lt;/a> &lt;span class="ex">/var/lib/docker&lt;/span> /mnt/var/lib&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;p>注意最后 不要变成 &lt;code>/mnt/var/lib&lt;/code> 否则就变成 &lt;code>/mnt/var/lib/docker/docker&lt;/code>….&lt;/p>
&lt;h3 id="docker-复杂的点在-nvidia">2. Docker 复杂的点在 nvidia&lt;/h3>
&lt;p>Copy /etc/docker/&lt;/p>
&lt;p>然后 docker 就 起不来了。日志&lt;/p>
&lt;pre class="log">&lt;code>E: Unable to locate package nvidia-container-toolkit-base&lt;/code>&lt;/pre>
&lt;p>然后找到这个&lt;/p>
&lt;p>https://gitlab.com/nvidia/container-toolkit/container-toolkit/-/tree/main/&lt;/p>
&lt;blockquote>
&lt;p>The NVIDIA Container Toolkit allows users to build and run GPU accelerated containers. The toolkit includes a container runtime library and utilities to automatically configure containers to leverage NVIDIA GPUs.&lt;/p>
&lt;/blockquote>
&lt;p>也就时说 container 要使用 &lt;code>nvidia&lt;/code> 需要装 &lt;code>nvidia-container-toolkit&lt;/code>(也就是 &lt;code>/etc/docker/daemon.json&lt;/code> 中这行的作用 &lt;code>"path": "nvidia-container-runtime"&lt;/code>)&lt;/p>
&lt;p>安装分两个&lt;/p>
&lt;ol type="1">
&lt;li>nvidia driver https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html#nvidia-drivers&lt;/li>
&lt;li>nvidia-container-toolkit https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html#installation-guide&lt;/li>
&lt;/ol>
&lt;p>其实是一篇文档…关于安装 &lt;code>nvidia-container-toolkit&lt;/code> 的&lt;/p>
&lt;h4 id="安装-nvidia-container-toolkit">安装 &lt;code>nvidia-container-toolkit&lt;/code>&lt;/h4>
&lt;h5 id="pre-requests">pre-requests&lt;/h5>
&lt;p>注意左侧目录层次，Pre-Requisites 只包含两个 （我看走眼了 Container Device Interface (CDI) Support 这个不是必须的，这节说要装 &lt;code>nvidia-container-toolkit-base&lt;/code> 不是很明白）&lt;/p>
&lt;ul>
&lt;li>NVIDIA Drivers （这个选用包管理器安装的 https://docs.nvidia.com/datacenter/tesla/tesla-installation-notes/index.html#package-manager , 并且不用管 post-installation steps 这个是 cuda 的，我们这里不需要 cuda，只要 driver)&lt;/li>
&lt;li>Platform Requirements (默认够了)&lt;/li>
&lt;/ul>
&lt;h5 id="nvidia-container-toolkit">&lt;code>nvidia-container-toolkit&lt;/code>&lt;/h5>
&lt;p>参照 https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html#docker&lt;/p>
&lt;p>这里有一点是 20.04 是指向 18.04 的源，文档里也有说，然后就 ok 了。&lt;/p>
&lt;p>由于已开始 rsync 那里敲错了，之前的几个 container, image 都没找到，所以怀疑是迁移出了问题，然后就看到了这个。。。如何迁移？删除。。。不过，有可能是提交成一个 image 再新开 container 就可以了，由于我们以前用的是 nvidia-docker 2 的，就没关系了。&lt;/p>
&lt;p>https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/migrating-from-1.0.html#migration-1-0&lt;/p></description></item></channel></rss>